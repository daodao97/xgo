import"./vue-DN4gkHAd.js";import{c as qe,p as kt,V as pa,U as ve,F as ce,I as ma,D as fa,u as nt,z as _t,y as ha,_ as ba,o as ya,L as va,s as ne,Q as wt,W as ge,S as ga}from"./okiss-utils-DhcqfsqG.js";import{c as ka,d as Ue}from"./pinia-C6DLEKUM.js";import{a as Y}from"./js-cookie-C2b7Ongr.js";import{z as xt,E as St,a as Et,b as pe,c as _a,d as wa,e as fe,f as It,g as xa,h as Sa,i as Ea,j as Ia,k as Ta,l as Tt,m as oe,n as Ba,o as Ca,p as Oa,q as Fe,r as Ge,s as Aa,t as Pa,u as Da,v as La,w as Bt,x as Ct,y as Ot,A as $a,B as Ma,C as Ra,D as ja,F as Se,G as He,H as Va}from"./element-plus-D6aQvmy-.js";import{l as b,N as Na}from"./lodash-VcOuY8SV.js";import{R as Be}from"./mockjs-pGl1GCrV.js";import{a as ze}from"./axios-B9ygI19o.js";import"./dayjs-CkAwaXN9.js";import{c as qa,a as Ua,u as Ee,b as W,o as Fa,d as Ga}from"./vue-router-CaiYjm2C.js";import{d as Ha}from"./path-to-regexp-BqOC2I1t.js";import{W as Ke,J as Je,Y as ee,X as me,I as za,v as Ka,a as Ja}from"./okiss-vbtf-DjSt3lQs.js";/* empty css                      */import{g as Wa}from"./mitt-B5Ys3zB6.js";import{Q as Xa,R as Qa}from"./element-plus-icons-vue-DKDK8PjB.js";import{m as Za}from"./vueuse-core-xLpC42wQ.js";import{x as Ya}from"./vue3-markdown-it-CEcmDVXz.js";import{E as el}from"./crypto-js-KBIJCNhe.js";import{N as Me}from"./nprogress-DMJkOZZh.js";import{r as E,u as f,i as We,e as tl,d as al}from"./vue-reactivity-C_72soeA.js";import{d as z,c as w,e as g,f as o,h as k,l as ke,q as O,v as c,k as r,t as I,F as A,J as N,a as he,o as Ie,j as h,s as Xe,P as M,r as de,K as se,m as X,G as Qe,p as ll,x as il,g as nl,M as ol,Q as sl}from"./vue-runtime-core-FXhYHVgh.js";import{d as Ce,c as ot,w as st,T as rl,e as ul,f as cl}from"./vue-runtime-dom-Cn9-AkrD.js";import{t as L,e as te,n as dl,g as Q}from"./vue-shared-Bk1_eoCT.js";String.prototype.format||(String.prototype.format=function(){const e=arguments;return this.replace(/{(\d+)}/g,function(t,a){return typeof e[a]<"u"?e[a]:t})});const Ze="oms:token";function be(){return Y.get(Ze)||""}function pl(e){const t=U(R),a=new Date(new Date().getTime()+(t.tokenExpire||1440*60*1e3));return Y.set(Ze,e,{expires:a})}function At(){return Y.remove(Ze)}let Pt=null;function ml(e){Pt=e}function Oe(){return Pt}const fl={baseURL:"/api",withCredentials:!0,cacheEnable:!0},Dt={title:"oms",fixedHeader:!1,sidebarLogo:!0,logo:"http://assest.daodao.run/logo.png",closeNavNotice:!1,navBarNotice:"",hasNewMessage:!0,showPageJsonSchema:!1,loginTips:"",sso:{},ElementPlus:{size:"default",zIndex:3e3,locale:xt},nav:[],whiteRoutes:["/login"],tokenExpire:10080*60*1e3,defaultAvatar:"http://assest.daodao.run/avatar.jpg",envColor:{uat:"gray",pre:"green"},serviceOffLineNotice:"å½“å‰é¡µé¢åŠŸèƒ½æ­£åœ¨ç»´æŠ¤, è¯·ç¨åå†è¯•~~~",formMutex:!0,captcha:!0,themeMode:"light"},Ye={axios:fl,settings:Dt,plugins:[],mock:!1},hl=b.cloneDeep(Dt),U=Ue("settings",{state:()=>({...hl}),actions:{updateSettings(e){b.merge(this,e)}}}),rt={name:"",nickname:"",avatar:"",token:be(),customRouter:[],remoteRouter:[],menuRoutes:[],isLodeRemoteRoutes:!1,resource:{},roleIds:[],path:"",env:"",expired:!1},ut=e=>typeof e.name=="string"?e.name:e.path,V=Ue("user",{state:()=>({...rt}),actions:{updateToken(e){this.token=e,pl(e)},removeToken(){this.token="",At()},updateRemoteRouter(e){this.remoteRouter=e,this.isLodeRemoteRoutes=!0},setCustomRoutes(e){const t=new Set(this.customRouter.map(l=>ut(l))),a=e.filter(l=>!t.has(ut(l)));a.length&&(this.customRouter=this.customRouter.concat(a))},updateState({key:e,value:t}){this[e]=t},resetUser(){const e={...rt,token:be()};Object.assign(this,e)},SET_EXPIRED(){this.expired=!this.expired},login(e){return new Promise((t,a)=>{const l=Oe();if(!l){a("http client not init");return}l.request({url:"/user/login",method:"POST",data:e}).then(i=>{this.updateToken(i.data?.token||""),t(!0)}).catch(i=>a(i))})},logout(){this.removeToken(),this.resetUser()},info(){return new Promise((e,t)=>{const a=Oe();if(!a){t("http client not init");return}a.request({url:"/user/info",method:"GET"}).then(l=>{const i=l.data?.role_ids||[];this.updateState({key:"name",value:l.data?.name}),this.updateState({key:"nickname",value:l.data?.nickname}),this.updateState({key:"roleIds",value:i}),this.updateState({key:"env",value:l.data?.env});const n=l.data?.website||{};U().updateSettings(n),!Y.get("username")&&Y.set("username",l.data?.name),e(!0)}).catch(l=>t(l))})},loadRemoteRoutes(){return new Promise((e,t)=>{Oe()?.request({url:"/user/routes",method:"get"}).then(a=>{if(a.code===0){const l=a.data||[];e(l)}else t("error")}).catch(a=>{t(a)})})},SetExpired(){this.SET_EXPIRED()}}}),xe="sidebarStatus";function bl(){if(typeof window>"u")return;const e=window.localStorage.getItem(xe);if(e!==null)return e==="1";const t=Y.get(xe);if(t!==void 0)return!!t}function ct(e){typeof window<"u"&&window.localStorage.setItem(xe,e?"1":"0"),Y.set(xe,e?"1":"0")}const yl={sidebar:{opened:bl()??!0,withoutAnimation:!1},device:"desktop",pages:{},currentRouteMeta:{},builderSchema:{},baseURL:""},Z=Ue("app",{state:()=>({...yl}),actions:{TOGGLE_SIDEBAR(){this.sidebar.opened=!this.sidebar.opened,this.sidebar.withoutAnimation=!1,ct(this.sidebar.opened)},CLOSE_SIDEBAR(e){this.sidebar.opened=!1,ct(this.sidebar.opened),this.sidebar.withoutAnimation=e},TOGGLE_DEVICE(e){this.device=e},SET_PAGE_JSON_SCHEMA({page:e,json:t}){this.pages[e]=t},SET_CURRENT_META(e){this.currentRouteMeta=e},SET_BUILDER_SCHEMA(e){this.builderSchema=e},SET_BASE_API(e){this.baseURL=e},toggleSideBar(){this.TOGGLE_SIDEBAR()},closeSideBar({withoutAnimation:e}){this.CLOSE_SIDEBAR(e)},toggleDevice(e){this.TOGGLE_DEVICE(e)},setPageJsonSchema(e){this.SET_PAGE_JSON_SCHEMA(e)},setCurrentMeta(e){this.SET_CURRENT_META(e)},setBuilderSchema(e){this.SET_BUILDER_SCHEMA(e)},setBaseAPI(e){this.SET_BASE_API(e)}}}),R=ka();function vl(e){e.use(R)}const Lt="oms-theme",$t=E("light");let dt=!1,_e=null;function gl(e){const t=ce(e??void 0);if(typeof window>"u")return t;const a=window.localStorage?.getItem(Lt);return a==="dark"||a==="light"?a:e==="dark"||e==="light"?e:window.matchMedia?.("(prefers-color-scheme: dark)").matches?"dark":"light"}function kl(e){typeof window<"u"&&window.localStorage?.setItem(Lt,e)}function Ae(e){const t=ce(e);$t.value=t,ma(t),fa(t),kl(t)}function _l(e){if(typeof window>"u"||typeof window.matchMedia!="function"){_e=null;return}const t=window.matchMedia("(prefers-color-scheme: dark)"),a=l=>{const i=l.matches??t.matches;e(i?"dark":"light")};typeof t.addEventListener=="function"?t.addEventListener("change",a):t.addListener(a),_e=()=>{typeof t.removeEventListener=="function"?t.removeEventListener("change",a):t.removeListener(a),_e=null}}function Mt(){const e=U(),t=i=>{const n=ce(i);e.themeMode!==n?e.updateSettings({themeMode:n}):Ae(n)};if(!dt){dt=!0;const i=gl(e.themeMode);ce(e.themeMode)!==i?e.updateSettings({themeMode:i}):Ae(i),he(()=>e.themeMode,n=>{Ae(ce(n))},{immediate:!0}),_e?.(),_l(n=>{t(n)})}const a=w(()=>$t.value),l=w(()=>a.value==="dark");return{themeMode:a,isDark:l,setTheme:t,toggleTheme:()=>{t(l.value?"light":"dark")}}}const wl=z({__name:"App",setup(e){return Mt(),Qe(()=>{const t=document.getElementById("preloader");t!==null&&(document.body.removeChild(t),document.getElementById("preloader")?.remove(),ha("test-icon","//at.alicdn.com/t/font_2246548_zclaqxwmzq8.css"),ba(`.iconfont {
      font-size: 19px;
      font-style: normal;
      -webkit-font-smoothing: antialiased;
      font-family: iconfont !important;
    }`))}),window?.OmsOptions?.form?.vsPath&&ll("vsPath",window?.OmsOptions?.form?.vsPath),(t,a)=>{const l=M("router-view");return o(),h(l)}}});var re=(e=>(e.GET="get",e.POST="post",e.DELETE="delete",e.FETCH="fetch",e.OPTION="option",e.PUT="put",e))(re||{});const xl=[{type:"jump",text:"è·³è½¬",target:"http://github.com/daodao97"},{type:"api",text:"è¯·æ±‚æ¥å£",target:"/test_api",extra:{method:"POST",url:"/test_api"},props:{type:"warning"}},{type:"table",text:"è¡¨æ ¼",extra:{infoApi:"/student/list_info",listApi:"/student/list"},props:{type:"info"}},[{type:"jump",text:"è·³è½¬",target:"http://github.com/daodao97"},{type:"api",text:"è¯·æ±‚æ¥å£",extra:{method:"POST",url:"/test_api"}}],{type:"form",text:"è¡¨å•",extra:{infoApi:"/form",saveApi:"/save"},props:{type:"success"}}];[...Na.cloneDeep(xl)];const Sl={code:0,data:{"list|0-100":[{"id|0-1000":1,name:"@cname","sex|0-1":1,"score|0-100":60,link:"http://github.com/daodao97",image:"http://qupinapptest.oss-cn-beijing.aliyuncs.com/1/202002/d81d3c9dc7c3df7590d333f783a97995.jpeg",html:"<S>æ˜¾ç¤ºåˆ é™¤çº¿1</S>",json:{slogan:"å·¦æ‰‹ä»£ç å³æ‰‹è¯—"},richText:"åœ¨ä¸€æ®µæ–‡æœ¬ä¸­<çªå‡º|black|yellow>æ˜¾ç¤ºæŸäº›<æ–‡å­—|#ffffff|#000000>"}],page:{"count|1-10":2,"page|1-5":2}}},El={listMock:Sl},Il=[{method:re.POST,url:"/login",response(e){return{code:0,data:{name:"daodao97",token:"xxxxxxx"}}}},{method:re.GET,url:"/user/info",response(e){return{code:0,data:{role_ids:[1],resource:[[0,20,"formItems","radio"],[0,1,2]]}}}},{url:"/user/routes",method:re.GET,response:e=>({code:0,data:[{id:0,label:"",routes:[]}]})},{url:"/user/list",method:re.GET,response:e=>El.listMock}],Tl=[...Il],Re={};function Rt(e){e.forEach(t=>{const a=jt(t);Re[`${t.method}::${a}`]=t})}Rt(Tl);function jt(e){let t=e.url,a=e.baseURL||Ye.axios?.baseURL;return a||(a=""),typeof t=="string"?(t=("/"+a+t).split("/").filter(l=>l).join("/"),t+="(|\\?.*)$",new RegExp(t)):t}function Bl(){Object.keys(Re).forEach(e=>{const t=Re[e],a=jt(t);Be.mock(a,t.method,function(l){const{url:i,type:n,body:s}=l,u=ya(i),m=s?JSON.parse(s):{},p=t.response({query:u,data:m}),d=Be.mock(p);return va(i,{type:n,query:u,data:m,response:d}),Be.mock(d)})})}const Cl=Et,pt=St,Ol=ze.CancelToken,we={taskList:{},cacheList:new Map,uniqueId(e){return`${location.href}|${e.method}|${e.url}|`},addTask(e,t){const a=this.uniqueId(e);this.taskList[a]=t},delTask(e){const t=this.uniqueId(e),a=this.taskList[t];a&&a(e)},pending(e){const t=this.uniqueId(e);return!!this.taskList[t]},cache(e){const t=this.uniqueId(e),a=this.cacheList.get(t);if(a){if(a.expirationTime<new Date().getTime()){this.delCache(e);return}return a.response,a.response}},addCache(e,t){const a=this.uniqueId(e),l=e.cacheTime||0;l&&this.cacheList.set(a,{response:t,expirationTime:new Date().getTime()+l})},delCache(e){const t=this.uniqueId(e);return this.cacheList.delete(t)}},Al={onFulfilled:function(e){return e.cacheEnable===!1||(we.pending(e)&&we.delTask(e),e.cancelToken=new Ol(t=>{we.addTask(e,t)})),e},onRejected(e){return Promise.reject(e)}},Pl={onFulfilled:function(e){return e.config.cacheEnable===!1||e.config.method==="get"&&Object.keys(e.data).length>0&&we.addCache(e.config,e.data),e},onRejected(e){return Promise.reject(e)}},Vt={};function hs(e,t){Vt[e]=t}function Dl(e){return Vt[e]}const Ll=z({name:"Dashboard",setup(){const e=Dl("dashboard");if(e)return()=>c("span",null,[c(e,null,null)]);const t=w(()=>V().name);return()=>c("div",{class:"dashboard-container"},[c("div",{class:"dashboard-text"},[I("Hi "),t.value,I(" ğŸ˜„")])])}}),$=(e,t)=>{const a=e.__vccOpts||e;for(const[l,i]of t)a[l]=i;return a},$l=$(Ll,[["__scopeId","data-v-85165680"]]),Ml={data(){return{levelList:null}},watch:{$route(){this.getBreadcrumb()}},created(){this.getBreadcrumb()},methods:{getBreadcrumb(){let e=this.$route.matched.filter(a=>a.meta&&a.meta.title);const t=e[0];this.isDashboard(t)||(e=[{path:"/dashboard",meta:{title:"Dashboard"}}].concat(e)),this.levelList=e.filter(a=>a.meta&&a.meta.title&&a.meta.breadcrumb!==!1)},isDashboard(e){const t=e&&e.name;return t?t.trim().toLocaleLowerCase()==="Dashboard".toLocaleLowerCase():!1},pathCompile(e){const{params:t}=this.$route;return Ha.compile(e)(t)},handleLink(e){const{redirect:t,path:a}=e;if(t){this.$router.push(t);return}this.$router.push(this.pathCompile(a))}}},Rl={key:0,class:"no-redirect"},jl=["onClick"];function Vl(e,t,a,l,i,n){const s=Da,u=La;return o(),h(u,{class:"app-breadcrumb",separator:"/"},{default:r(()=>[c(ul,{name:"breadcrumb"},{default:r(()=>[(o(!0),g(A,null,N(i.levelList,(m,p)=>(o(),h(s,{key:m.path},{default:r(()=>[m.path.indexOf("/DIR_")===0&&m.redirect===void 0||p===i.levelList.length-1?(o(),g("span",Rl,L(m.meta.title),1)):(o(),g("a",{key:1,onClick:d=>n.handleLink(m)},L(m.meta.title),9,jl))]),_:2},1024))),128))]),_:1})]),_:1})}const Nl=$(Ml,[["render",Vl],["__scopeId","data-v-fa74804e"]]),ql={name:"Hamburger",props:{isActive:{type:Boolean,default:!1}},emits:["toggle-click"],methods:{toggleClick(){this.$emit("toggle-click")}}};function Ul(e,t,a,l,i,n){const s=M("v-icon");return o(),g("div",{style:{padding:"0 15px"},onClick:t[0]||(t[0]=(...u)=>n.toggleClick&&n.toggleClick(...u))},[c(s,{class:te({"is-active":a.isActive}),name:"ra-leftalignment"},null,8,["class"])])}const Fl=$(ql,[["render",Ul]]),Gl={};function Hl(e,t){const a=oe,l=$a,i=Ma,n=Ra;return o(),h(n,{style:{width:"100%",height:"100%"}},{default:r(()=>[c(a,{class:"aside"},{default:r(()=>[de(e.$slots,"left-aside",{},void 0,!0)]),_:3}),c(l,{class:"main",style:{margin:"0 10px"}},{default:r(()=>[de(e.$slots,"main",{},void 0,!0)]),_:3}),c(i,{class:"aside",width:"350px",style:{padding:"20px"}},{default:r(()=>[de(e.$slots,"right-aside",{},void 0,!0)]),_:3})]),_:3})}const Nt=$(Gl,[["render",Hl],["__scopeId","data-v-7c3d697b"]]),zl={type:"input",name:"æ–‡æœ¬æ¡†",default:{type:"input",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"sub-form",field:"props",label:"å±æ€§",props:{options:{labelPosition:"top"},formItems:[{type:"number",field:"maxlength",label:"æœ€å¤§å­—ç¬¦æ•°"},{type:"icon-select",field:"prefixIcon",label:"å‰ç½®ICON"},{type:"icon-select",field:"suffixIcon",label:"åç½®ICON"},{type:"switch",field:"showCopy",label:"å¤åˆ¶"},{type:"switch",field:"disabled",label:"ç¦ç”¨"},{type:"switch",field:"showWordLimit",label:"æ˜¾ç¤ºé™åˆ¶è¯æ•°"},{type:"input",field:"mask",label:"mask",info:'<a href="https://github.com/RobinHerbots/Inputmask" target="_blank" class="el-link el-link--primary">æ–‡æ¡£</a>'}]}}]},Kl={type:"number",name:"æ•°å­—",default:{type:"number",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"sub-form",field:"props",label:"å±æ€§",props:{options:{labelPosition:"top"},formItems:[{type:"number",field:"min",label:"æœ€å°å€¼"},{type:"number",field:"man",label:"æœ€å¤§å€¼"}]}}]},Jl={type:"number-range",name:"æ•°å­—åŒºé—´",default:{type:"number-range",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"sub-form",field:"props",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"unit",label:"å•ä½"},{type:"switch",field:"disabled",label:"ç¦ç”¨"}]}}]},Wl={type:"select",name:"ä¸‹æ‹‰æ¡†",default:{type:"select",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"radio",field:"optionType",label:"å¤‡é€‰é¡¹ç±»å‹",value:0,options:[{value:0,label:"local"},{value:1,label:"remote"}]},{type:"sub-form",field:"options",label:"å¤‡é€‰é¡¹",props:{repeat:!0,options:{labelPosition:"top"},formItems:[{type:"input",field:"value",label:"value"},{type:"input",field:"label",label:"label"}]},depend:{field:"optionType",value:0}},{type:"sub-form",field:"props",label:"å±æ€§",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"selectApi",label:"å¤‡é€‰é¡¹æ¥å£",depend:{field:".optionType",value:1}},{type:"switch",field:"multiple",label:"å¤šé€‰"},{type:"number",field:"multipleLimit",label:"æœ€å¤§é€‰ä¸­æ•°",depend:{field:"multiple",value:!0}},{type:"switch",field:"allowCreate",label:"å…è®¸åˆ›å»º"},{type:"switch",field:"filterable",label:"å…è®¸è¿‡æ»¤"}]}}],trans(e){const t=b.cloneDeep(e);return e.optionType===0?t.props&&t.props.selectApi!==void 0&&delete t.props.selectApi:e.optionType===1&&t.options&&delete t.options,delete t.optionType,t}},Xl={type:"radio",name:"å•é€‰æ¡†",default:{type:"radio",label:"label",field:"field_name",options:[]},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"sub-form",field:"options",label:"å¤‡é€‰é¡¹",props:{formItems:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"value",label:"å­—æ®µå€¼"}],repeat:!0}},{type:"input",field:"default",label:"é»˜è®¤å€¼"}]},Ql={type:"switch",name:"å¼€å…³",default:{type:"switch",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"sub-form",field:"props",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"activeText",label:"æ‰“å¼€æ—¶çš„æ–‡å­—æè¿°"},{type:"input",field:"inactiveText",label:"å…³é—­æ—¶çš„æ–‡å­—æè¿°"},{type:"color",field:"activeColor",label:"æ‰“å¼€æ—¶çš„èƒŒæ™¯è‰²"},{type:"color",field:"inactiveColor",label:"å…³é—­æ—¶çš„èƒŒæ™¯è‰²"},{type:"switch",field:"disabled",label:"ç¦ç”¨"}]}}]},Zl={type:"code",name:"Code",default:{type:"code",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"}]},Yl={type:"json",name:"json",default:{type:"json",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"}]},ei={type:"upload",name:"ä¸Šä¼ ",default:{type:"upload",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"}]},ti={type:"template",name:"è‡ªå®šä¹‰ç»„ä»¶",default:{type:"template",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"}]},ai={type:"icon-select",name:"å›¾æ ‡é€‰æ‹©å™¨",default:{type:"icon-select",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"}]},li={type:"sub-form",name:"å­è¡¨å•",default:{type:"sub-form",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"sub-form",field:"props",label:"å±æ€§",props:{options:{labelPosition:"top"},formItems:[{type:"switch",field:"repeat",label:"å¯é‡å¤"},{type:"sub-form",field:"form-items",label:"å­è¡¨å•æ§ä»¶",props:{options:{labelPosition:"top"},repeat:!0,formItems:[{type:"input",field:"label",label:"label"},{type:"select",field:"type",label:"ç±»å‹",options:[{value:"input",label:"æ–‡æœ¬æ¡†"}]}]}},{type:"switch",field:"disabled",label:"ç¦ç”¨"}]}}]},ii={type:"checkbox",name:"å¤é€‰æ¡†",default:{type:"checkbox",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"sub-form",field:"props",props:{options:{labelPosition:"top"},formItems:[{type:"number",field:"max",label:"æœ€å¤§é€‰ä¸­æ•°"},{type:"number",field:"min",label:"æœ€å°é€‰ä¸­æ•°"},{type:"switch",field:"disabled",label:"ç¦ç”¨"}]}}]},qt={};function G(e){qt[e.type]=e}G(zl);G(Wl);G(Kl);G(Jl);G(Ql);G(li);G(Xl);G(ii);G(Zl);G(Yl);G(ei);G(ai);G(ti);const je=qt,ni={options:{labelPosition:"top",submitButton:!1,cancelButton:!1},formItems:[{type:"input",field:"saveApi",label:"ä¿å­˜æ¥å£"},{type:"switch",field:"inline",label:"è¡Œå¸ƒå±€"},{type:"radio",field:"labelPosition",label:"labelä½ç½®",options:[{value:"right",label:"å³"},{value:"left",label:"å·¦"},{value:"top",label:"ä¸Š"}]},{type:"input",field:"labelWidth",label:"labelå®½åº¦",value:"100px"},{type:"switch",field:"showSubmitButton",label:"æ˜¾ç¤ºæäº¤æŒ‰é’®",value:!0},{type:"sub-form",field:"submitButton",label:"æäº¤æŒ‰é’®",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"text",label:"æ–‡æ¡ˆ",value:"æäº¤"},{type:"select",field:"type",label:"æŒ‰é’®ç±»å‹",options:[{value:"primary",label:"primary"}]}]}},{type:"switch",field:"showCancelButton",label:"æ˜¾ç¤ºå–æ¶ˆæŒ‰é’®",value:!0},{type:"sub-form",field:"cancelButton",label:"å–æ¶ˆæŒ‰é’®",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"text",label:"æ–‡æ¡ˆ",value:"å–æ¶ˆ"},{type:"select",field:"type",label:"æŒ‰é’®ç±»å‹",options:[{value:"primary",label:"primary"}]}]}}]},Pe={labelPosition:"top",submitButton:!1,cancelButton:!1},et=[];Object.keys(je).forEach(e=>{et.push({value:e,label:je[e].name})});const oi={options:{submitButton:!1,cancelButton:!1},formItems:[{type:"sub-form",field:"columns",props:{repeat:!0,formItems:[{type:"input",field:"field",label:"å­—æ®µkey"},{type:"select",field:"type",label:"ç±»å‹",options:b.cloneDeep(et)},{type:"input",field:"label",label:"å­—æ®µlabel"}]}}]},si={components:{DevLayout:Nt,VForm:ee,VButton:Ke,JsonView:Je},props:{schema:{type:Object,default:e=>{}}},data(){return{sqlOptions:{},sqlSchema:oi,baseSchema:ni,activeTab:"base",builderSchema:Object.assign({},this.$props.schema,{options:{submitButton:!1,cancelButton:!1}}),baseOptions:{},key:0,ctrlKey:0,activeCtrl:void 0,ctrlOptions:{},ctrlSchema:{},ctrlName:"",activeIndex:void 0,ctrlMap:je,activeIndexReg:/(formItems)?\[(\d+)\]/,tableStruct:"",activeName:"1",currentCtrlType:"input",types:b.cloneDeep(et)}},computed:{getSaveSchema(){return{formItems:this.builderSchema.formItems}}},watch:{baseOptions:{deep:!0,immediate:!0,handler(e){const t=b.cloneDeep(e);e.showSubmitButton===!1&&(t.submitButton=!1),e.cancelSubmitButton===!1&&(t.cancelButton=!1),delete t.showSubmitButton,delete t.showCancelButton,Object.keys(t).length>0&&(this.builderSchema=b.merge(this.builderSchema,{options:t}),this.key++)}},ctrlOptions:{deep:!0,handler(e){const t=b.get(this.builderSchema,this.activeIndex);if(!t)return;const a=t?t.type:"",l=this.ctrlMap[a],i=l.trans?l.trans(e):e;if(i&&Object.keys(i).length>0){if(i.type=a,this.activeIndex.indexOf("[")>-1){const[n,s,u]=this.activeIndex.match(/(\w+)\[(\d+)\]/);this.builderSchema[s][u]={...i}}else this.builderSchema[this.activeIndex]=i;this.key++}}},currentCtrlType:{handler(e){const t=this.ctrlMap[e];this.ctrlSchema=b.cloneDeep({options:b.cloneDeep(Pe),formItems:b.cloneDeep(t.builder)});const a=b.get(this.builderSchema,this.activeIndex);this.ctrlOptions=b.cloneDeep(a),this.ctrlOptions.type=e,this.ctrlKey++,this.key++}}},beforeCreate(){le.on("dev-action",({event:e,data:t})=>{this.onDevAction(t.type,t.devId)})},unmounted(){le.off("dev-action")},methods:{onDevAction(e,t){this.activeIndex="formItems"+t,e==="edit"&&(this.activeTab="ctrl",this.clicklabel()),e==="del"&&(this.activeTab="base",this.removeOne()),this.ctrlKey++},push(e){const t="formItems";this.ctrlOptions={},this.builderSchema[t]=this.builderSchema[t]||[];const a=this.ctrlMap[e];this.activeCtrl=a,this.builderSchema[t].push(b.cloneDeep(a.default)),this.ctrlSchema=b.cloneDeep({options:b.cloneDeep(Pe),formItems:b.cloneDeep(a.builder)}),this.ctrlKey++,this.key++,this.activeIndex=`${t}[${this.builderSchema[t].length-1}]`,this.activeTab="ctrl"},removeOne(){b.unset(this.builderSchema,this.activeIndex),this.builderSchema=b.cloneDeep(_t(this.builderSchema)),this.activeIndex="",this.ctrlOptions={},this.ctrlSchema={},this.key++,this.ctrlKey++},clicklabel(){const e=this.activeIndex;if(e.match(this.activeIndexReg)){const t=b.cloneDeep(b.get(this.builderSchema,e)),a=t.type,l=this.ctrlMap[a];if(!l){this.$message({type:"warning",message:"å°šæœªæ”¯æŒè¯¥ç»„ä»¶çš„UIç¼–è¾‘"});return}this.currentCtrlType=a,this.ctrlOptions=t,this.ctrlSchema=b.cloneDeep({options:b.cloneDeep(Pe),formItems:b.cloneDeep(l.builder)}),this.ctrlKey++}},saveSchema(){this.$http.request({method:"POST",url:"/devtool/page_schema",data:{formItems:this.builderSchema.formItems}}).then(({data:e})=>{e&&this.$message({type:"success",message:"ä¿å­˜æˆåŠŸ, è¯·åˆ·æ–°é¡µé¢æŸ¥çœ‹æ•ˆæœ"})})}}};function ri(e,t,a,l,i,n){const s=M("v-form"),u=Ot,m=pe,p=M("JsonView"),d=M("VButton"),_=Fe,x=Ge,v=Ct,T=Bt,B=M("dev-layout");return o(),h(B,null,{main:r(()=>[i.builderSchema.formItems?(o(),h(s,X({ref:"form",key:i.key,dev:!0},i.builderSchema),null,16)):O("",!0),c(u),c(m,{type:"primary",onClick:n.saveSchema},{default:r(()=>[...t[2]||(t[2]=[I("ä¿å­˜é¡µé¢é…ç½®",-1)])]),_:1},8,["onClick"]),t[3]||(t[3]=I(" Â Â  ",-1)),c(d,{text:"PageSchema",type:"modal"},{default:r(()=>[c(p,{data:n.getSaveSchema},null,8,["data"])]),_:1})]),"right-aside":r(()=>[i.activeIndex?(o(),h(T,{key:0},{default:r(()=>[c(v,{label:"æ§ä»¶ç±»å‹"},{default:r(()=>[c(x,{modelValue:i.currentCtrlType,"onUpdate:modelValue":t[0]||(t[0]=y=>i.currentCtrlType=y)},{default:r(()=>[(o(!0),g(A,null,N(i.types,(y,S)=>(o(),h(_,{key:S,label:y.label,value:y.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):O("",!0),(o(),h(s,X({key:i.ctrlKey,modelValue:i.ctrlOptions,"onUpdate:modelValue":t[1]||(t[1]=y=>i.ctrlOptions=y)},i.ctrlSchema),null,16,["modelValue"]))]),_:1})}const ui=$(si,[["render",ri],["__scopeId","data-v-875f0171"]]),ci={type:"input",name:"æ–‡æœ¬æ¡†",default:{type:"input",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"sub-form",field:"props",label:"å±æ€§",props:{options:{labelPosition:"top"},formItems:[{type:"number",field:"maxlength",label:"æœ€å¤§å­—ç¬¦æ•°"},{type:"switch",field:"showWordLimit",label:"æ˜¾ç¤ºé™åˆ¶è¯æ•°"},{type:"input",field:"mask",label:"mask",info:'<a href="https://github.com/RobinHerbots/Inputmask" target="_blank" class="el-link el-link--primary">æ–‡æ¡£</a>'}]}}]},di={type:"select",name:"ä¸‹æ‹‰æ¡†",default:{type:"select",label:"label",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"radio",field:"optionType",label:"å¤‡é€‰é¡¹ç±»å‹",value:0,options:[{value:0,label:"local"},{value:1,label:"remote"}]},{type:"sub-form",field:"options",label:"å¤‡é€‰é¡¹",props:{repeat:!0,options:{labelPosition:"top"},formItems:[{type:"input",field:"value",label:"value"},{type:"input",field:"label",label:"label"}]},depend:{field:"optionType",value:0}},{type:"sub-form",field:"props",label:"å±æ€§",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"selectApi",label:"å¤‡é€‰é¡¹æ¥å£",depend:{field:".optionType",value:1}},{type:"switch",field:"multiple",label:"å¤šé€‰"},{type:"number",field:"multipleLimit",label:"æœ€å¤§é€‰ä¸­æ•°",depend:{field:"multiple",value:!0}},{type:"switch",field:"filterable",label:"å…è®¸è¿‡æ»¤"}]}}],trans(e){const t=b.cloneDeep(e);return e.optionType===0?t.props&&t.props.selectApi!==void 0&&delete t.props.selectApi:e.optionType===1&&t.options&&delete t.options,delete t.optionType,t}},pi={type:"date",name:"æ—¥æœŸ",default:{type:"date",label:"æ—¶é—´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"}]},mt={options:{labelPosition:"top",submitButton:!1,cancelButton:!1},formItems:[{type:"switch",field:"showFilter",label:"æœç´¢æ¡ä»¶",value:!0},{type:"switch",field:"showPagination",label:"é¡µç ",value:!0},{type:"switch",field:"exportAble",label:"å¯¼å‡ºæŒ‰é’®"}]},De={labelPosition:"top",submitButton:!1,cancelButton:!1},mi={type:"span",name:"æ–‡æœ¬",default:{type:"span",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"},{type:"switch",field:"sortable",label:"æ’åº"}]},fi={type:"enum",name:"æ ‡ç­¾",default:{type:"enum",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"},{type:"sub-form",field:"options",label:"æ˜ å°„",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"value",label:"value"},{type:"input",field:"label",label:"label"}]},value:[]}],trans(e){return e.options=e.options||[],e.label||(e.label="è¡¨å¤´"),e}},hi={type:"html",name:"HTML",default:{type:"html",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"}]},bi={type:"icon",name:"å›¾æ ‡",default:{type:"icon",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"}]},yi={type:"image",name:"å›¾ç‰‡",default:{type:"image",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"}]},vi={type:"json",name:"JSON",default:{type:"json",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"}]},gi={type:"link",name:"é“¾æ¥",default:{type:"link",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"}]},ki={type:"rich",name:"å¯Œæ–‡æœ¬",default:{type:"rich",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"}]},_i={type:"tpl",name:"æ¨¡æ¿",default:{type:"tpl",label:"è¡¨å¤´",field:"field_name"},builder:[{type:"input",field:"label",label:"å­—æ®µå"},{type:"input",field:"field",label:"å­—æ®µkey"},{type:"input",field:"info",label:"æç¤º"},{type:"input",field:"tpl",label:"æ¨¡æ¿",info:"ä¾‹å¦‚ <code>å§“å: {name} å¹´é¾„:{age}</code>"}]},wi={span:mi,enum:fi,html:hi,icon:bi,image:yi,json:vi,link:gi,rich:ki,tpl:_i},xi={type:"jump",name:"è·³è½¬",default:{type:"jump",target:"",text:"æŒ‰é’®"},builder:[{type:"input",field:"target",label:"è·³è½¬åœ°å€",info:"å¯ä»¥æ˜¯æœ¬åœ°è·¯ç”±, ä¹Ÿå¯ä»¥æ˜¯url"},{type:"input",field:"text",label:"æ–‡æ¡ˆ"},{type:"sub-form",field:"props",label:"å±æ€§",props:{options:{labelPosition:"top"},formItems:[{type:"icon-select",field:"icon",label:"å›¾æ ‡"},{type:"select",field:"type",label:"ç±»å‹",options:[{value:"primary",label:"primary"},{value:"info",label:"info"}]}]}}]},Si={type:"api",name:"æ¥å£è¯·æ±‚",default:{type:"api",target:"",text:"è¯·æ±‚"},builder:[{type:"input",field:"target",label:"APIåœ°å€",info:"æ­¤å¤„å¡«å†™æ¥å£pathå³å¯"},{type:"input",field:"text",label:"æ–‡æ¡ˆ"},{type:"sub-form",field:"props",label:"å±æ€§",props:{options:{labelPosition:"top"},formItems:[{type:"input",field:"text",label:"æ–‡æ¡ˆ"},{type:"icon-select",field:"icon",label:"å›¾æ ‡"},{type:"select",field:"type",label:"ç±»å‹",options:[{value:"primary",label:"primary"},{value:"info",label:"info"}]},{type:"input",field:"api",label:"APIåœ°å€",info:"æ­¤å¤„å¡«å†™æ¥å£pathå³å¯"},{type:"select",field:"method",label:"è¯·æ±‚ç±»å‹",options:[{value:"GET",label:"GET"},{value:"POST",label:"POST"},{value:"DELETE",label:"DELETE"},{value:"PUT",label:"PUT"}]}]}}]},Ei={type:"form",name:"å¼¹æ¡†è¡¨å•",default:{type:"form",target:"",text:"å¼¹æ¡†è¡¨å•"},builder:[{type:"input",field:"text",label:"æ–‡æ¡ˆ"},{type:"radio",field:"container",label:"æ¨¡å¼",options:[{value:"dialog",label:"æ¨¡æ€æ¡†"},{value:"drawer",label:"æŠ½å±‰"}],value:"dialog"},{type:"radio",field:"schema_type",label:"è¡¨å•ç±»å‹",options:[{value:0,label:"æœ¬åœ°"},{value:1,label:"è¿œç¨‹"}],value:1},{type:"input",field:"infoApi",label:"formSchemaæ¥å£",depend:{field:"schema_type",value:1}},{type:"json",field:"form-items",label:"è¡¨å•æ§ä»¶"},{type:"input",field:"saveApi",label:"ä¿å­˜æ¥å£"}]},Ii={type:"table",name:"å¼¹æ¡†åˆ—è¡¨",default:{type:"form",target:"",text:"å¼¹æ¡†è¡¨å•"},builder:[{type:"input",field:"text",label:"æ–‡æ¡ˆ"},{type:"radio",field:"container",label:"æ¨¡å¼",options:[{value:"dialog",label:"æ¨¡æ€æ¡†"},{value:"drawer",label:"æŠ½å±‰"}],value:"dialog"},{type:"radio",field:"schema_type",label:"è¡¨å•ç±»å‹",options:[{value:0,label:"æœ¬åœ°"},{value:1,label:"è¿œç¨‹"}],value:1},{type:"input",field:"infoApi",label:"formSchemaæ¥å£",depend:{field:"schema_type",value:1}},{type:"json",field:"form-items",label:"è¡¨å•æ§ä»¶"},{type:"input",field:"saveApi",label:"ä¿å­˜æ¥å£"}]},Ti={jump:xi,api:Si,form:Ei,table:Ii},Bi={components:{JsonView:Je,DevLayout:Nt,VTable:me,VForm:ee,VButton:Ke},props:{schema:{type:Object,default:e=>{}}},data(){const e=tl(this.$props.schema);return delete e.listApi,e.list=[{}],{baseSchema:mt,activeTab:"base",builderSchema:Object.assign({},mt,e),baseOptions:{},key:0,ctrlKey:0,activeCtrl:void 0,activeBrick:void 0,ctrlOptions:{},ctrlSchema:{},ctrlName:"",activeIndex:void 0,ctrlMap:{filter:{input:ci,select:di,date:pi},headers:wi,buttons:Ti},activeIndexReg:/(filter|headers|normalButton|batchButton|rowButton)?\[(\d+)\]/,currentCtrlType:"input"}},computed:{types(){const e=[],t=this.ctrlMap[this.activeBrick];return Object.keys(t).forEach(a=>{e.push({value:a,label:t[a].name})}),e},getSaveSchema(){return{filter:this.builderSchema.filter,headers:this.builderSchema.headers,rowButton:this.builderSchema.rowButton,normalButton:this.builderSchema.normalButton,batchButton:this.builderSchema.batchButton}},currentBuilderSchema(){return this.$pinia?.state?.value?.app?.builderSchema}},watch:{baseOptions:{deep:!0,immediate:!0,handler(e){this.builderSchema=b.merge(this.builderSchema,e),this.key++,this.updateBuilderSchema()}},ctrlOptions:{deep:!0,handler(e){const t=this.activeIndex.match(this.activeIndexReg);if(!t)return;let a=this.builderSchema[t[1]][parseInt(t[2])].type;t[1]==="headers"&&a===void 0&&(a="span");const l=this.ctrlMap[this.activeBrick][a];if(!l)return;const i=l.trans?l.trans(e):e;if(i&&Object.keys(i).length>0){if(i.type=a,this.activeIndex.indexOf("[")>-1){const[n,s,u]=this.activeIndex.match(/(\w+)\[(\d+)\]/);this.builderSchema[s][u]={...i}}else this.builderSchema[this.activeIndex]=i;this.key++}this.updateBuilderSchema()}},currentCtrlType:{handler(e){const t=this.ctrlMap[this.activeBrick][e];this.ctrlSchema=b.cloneDeep({options:b.cloneDeep(De),formItems:b.cloneDeep(t.builder)});const a=b.get(this.builderSchema,this.activeIndex);a.type=e;const l=b.cloneDeep(a);this.ctrlOptions=l,l.text&&(this.ctrlOptions.text=l.text,this.ctrlOptions.props=l.props||{}),this.ctrlKey++,this.key++,this.updateBuilderSchema()}}},beforeCreate(){le.on("dev-action",({event:e,data:t})=>{this.onDevAction(t.type,t.devId)})},unmounted(){le.off("dev-action")},methods:{updateBuilderSchema(){const e=this.$pinia?._s?.get("app")||null;e&&e.setBuilderSchema&&e.setBuilderSchema(this.builderSchema)},onDevAction(e,t){this.activeIndex=t,e==="edit"&&(this.activeTab="ctrl",this.clicklabel()),e==="del"&&(this.activeTab="base",this.removeOne()),this.ctrlKey++},pushFilter(e){this.push(e,"filter","filter","filter")},pushHeaders(e){this.push(e,"headers","headers","headers")},pushNormalButton(e){this.push(e,"normalButton","buttons","buttons")},pushBatchButton(e){this.push(e,"batchButton","buttons","buttons")},pushRowButton(e){this.push(e,"rowButton","buttons","buttons")},push(e,t,a,l){const i=this.ctrlMap[a];if(!i[e]){this.$message({type:"warning",message:"å°šæœªæ”¯æŒæ­¤ç»„ä»¶çš„UIç¼–è¾‘"});return}this.activeCtrl=i[e],this.activeBrick=l,this.ctrlOptions={},this.builderSchema[t]=this.builderSchema[t]||[],this.builderSchema[t].push(b.cloneDeep(i[e].default)),this.ctrlSchema=b.cloneDeep({options:b.cloneDeep(De),formItems:b.cloneDeep(i[e].builder)}),this.key++,this.ctrlKey++,this.activeIndex=`${t}[${this.builderSchema[t].length-1}]`,this.activeTab="ctrl"},removeOne(){b.unset(this.builderSchema,this.activeIndex),this.builderSchema=b.cloneDeep(_t(this.builderSchema)),this.activeIndex="",this.ctrlOptions={},this.ctrlSchema={},this.key++,this.ctrlKey++},clicklabel(){const e=this.activeIndex,t=e.match(this.activeIndexReg);if(t){const a=b.cloneDeep(b.get(this.builderSchema,e));this.activeBrick=t[1],["normalButton","batchButton","rowButton"].indexOf(t[1])>-1&&(this.activeBrick="buttons");let l=this.builderSchema[t[1]][parseInt(t[2])].type;t[1]==="headers"&&l===void 0&&(l="span");const i=this.ctrlMap[this.activeBrick][l];if(!i){this.activeBrick,this.$message({type:"warning",message:"å°šæœªæ”¯æŒæ­¤ç»„ä»¶çš„UIç¼–è¾‘"});return}this.ctrlOptions=a,this.currentCtrlType=l,this.ctrlSchema=b.cloneDeep({options:b.cloneDeep(De),formItems:b.cloneDeep(i.builder)}),this.ctrlKey++}},saveSchema(){const{filter:e,headers:t,rowButton:a,normalButton:l,batchButton:i}=this.currentBuilderSchema;this.$http.request({method:"POST",url:"/devtool/page_schema",data:{filter:e,headers:t,rowButton:a,normalButton:l,batchButton:i}}).then(({data:n})=>{n&&this.$message({type:"success",message:"ä¿å­˜æˆåŠŸ, è¯·åˆ·æ–°é¡µé¢æŸ¥çœ‹æ•ˆæœ"})})}}};function Ci(e,t,a,l,i,n){const s=fe,u=pe,m=oe,p=M("v-table"),d=Ot,_=pe,x=M("JsonView"),v=M("VButton"),T=Fe,B=Ge,y=Ct,S=Bt,P=M("v-form"),D=M("dev-layout");return o(),h(D,null,{"left-aside":r(()=>[c(m,{style:{width:"200px"}},{default:r(()=>[c(m,null,{default:r(()=>[c(s,{class:"title","data-id":22222},{default:r(()=>[...t[5]||(t[5]=[I("æ·»åŠ æœç´¢æ¡ä»¶",-1)])]),_:1}),c(s,{class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn",onClick:t[0]||(t[0]=C=>n.pushFilter("input"))},{default:r(()=>[...t[6]||(t[6]=[I("æ–‡æœ¬æ¡†",-1)])]),_:1})]),_:1}),c(s,{class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn",onClick:t[1]||(t[1]=C=>n.pushFilter("select"))},{default:r(()=>[...t[7]||(t[7]=[I("ä¸‹æ‹‰æ¡†",-1)])]),_:1})]),_:1}),c(s,{class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn",onClick:t[2]||(t[2]=C=>n.pushFilter("date"))},{default:r(()=>[...t[8]||(t[8]=[I("æ—¥æœŸ",-1)])]),_:1})]),_:1})]),_:1}),c(m,null,{default:r(()=>[c(s,{class:"title"},{default:r(()=>[...t[9]||(t[9]=[I("æ·»åŠ åˆ—è¡¨é¡¹",-1)])]),_:1}),(o(!0),g(A,null,N(Object.keys(i.ctrlMap.headers),(C,F)=>(o(),h(s,{key:`column-${F}`,class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn",onClick:K=>n.pushHeaders(i.ctrlMap.headers[C].type)},{default:r(()=>[I(L(i.ctrlMap.headers[C].name),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),c(m,null,{default:r(()=>[c(s,{class:"title"},{default:r(()=>[...t[10]||(t[10]=[I("æ·»åŠ è¡ŒæŒ‰é’®",-1)])]),_:1}),(o(!0),g(A,null,N(Object.keys(i.ctrlMap.buttons),(C,F)=>(o(),h(s,{key:`column-${F}`,class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn",onClick:K=>n.pushRowButton(i.ctrlMap.buttons[C].type)},{default:r(()=>[I(L(i.ctrlMap.buttons[C].name),1)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}),c(m,null,{default:r(()=>[c(s,{class:"title"},{default:r(()=>[...t[11]||(t[11]=[I("æ·»åŠ å¸¸è§„æŒ‰é’®",-1)])]),_:1}),(o(!0),g(A,null,N(Object.keys(i.ctrlMap.buttons),(C,F)=>(o(),h(s,{key:`column-${F}`,class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn",onClick:K=>n.pushNormalButton(i.ctrlMap.buttons[C].type)},{default:r(()=>[I(L(i.ctrlMap.buttons[C].name),1)]),_:2},1032,["onClick"])]),_:2},1024))),128)),c(s,{class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn"},{default:r(()=>[...t[12]||(t[12]=[I("æŒ‰é’®ç»„",-1)])]),_:1})]),_:1})]),_:1}),c(m,null,{default:r(()=>[c(s,{class:"title"},{default:r(()=>[...t[13]||(t[13]=[I("æ·»åŠ æ‰¹é‡æŒ‰é’®",-1)])]),_:1}),(o(!0),g(A,null,N(Object.keys(i.ctrlMap.buttons),(C,F)=>(o(),h(s,{key:`column-${F}`,class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn",onClick:K=>n.pushBatchButton(i.ctrlMap.buttons[C].type)},{default:r(()=>[I(L(i.ctrlMap.buttons[C].name),1)]),_:2},1032,["onClick"])]),_:2},1024))),128)),c(s,{class:"ctrl"},{default:r(()=>[c(u,{class:"ctrl-btn"},{default:r(()=>[...t[14]||(t[14]=[I("æŒ‰é’®ç»„",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),main:r(()=>[(o(),h(p,X({ref:"table",key:i.key,dev:!0},i.builderSchema),null,16)),c(d),c(_,{type:"primary",onClick:n.saveSchema},{default:r(()=>[...t[15]||(t[15]=[I("ä¿å­˜é¡µé¢é…ç½®",-1)])]),_:1},8,["onClick"]),t[16]||(t[16]=I(" Â Â  ",-1)),c(v,{text:"PageSchema",type:"modal"},{default:r(()=>[c(x,{data:n.getSaveSchema},null,8,["data"])]),_:1})]),"right-aside":r(()=>[i.activeIndex?(o(),h(S,{key:0},{default:r(()=>[c(y,{label:"æ§ä»¶ç±»å‹"},{default:r(()=>[c(B,{modelValue:i.currentCtrlType,"onUpdate:modelValue":t[3]||(t[3]=C=>i.currentCtrlType=C)},{default:r(()=>[(o(!0),g(A,null,N(n.types,(C,F)=>(o(),h(T,{key:F,label:C.label,value:C.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):O("",!0),(o(),h(P,X({key:i.ctrlKey,modelValue:i.ctrlOptions,"onUpdate:modelValue":t[4]||(t[4]=C=>i.ctrlOptions=C)},i.ctrlSchema),null,16,["modelValue"]))]),_:1})}const Oi=$(Bi,[["render",Ci],["__scopeId","data-v-cd18f87f"]]),Ai="rtl",Pi={__name:"PageEditor",setup(e){const t=E(!1);E(1);const a=W(),l=Z(),i=w(()=>l.pages[a.path]);return(n,s)=>{const u=M("VIcon"),m=Tt;return o(),g(A,null,[c(u,{name:"ra-set",onClick:s[0]||(s[0]=p=>t.value=!f(t))}),c(m,{modelValue:f(t),"onUpdate:modelValue":s[1]||(s[1]=p=>We(t)?t.value=p:null),title:"é¡µé¢è®¾è®¡",class:"my-drawer",direction:Ai,size:"90%","destroy-on-close":"","append-to-body":""},{default:r(()=>[f(i).formItems!==void 0?(o(),h(ui,{key:0,schema:f(i)},null,8,["schema"])):O("",!0),f(i).headers!==void 0?(o(),h(Oi,{key:1,schema:f(i)},null,8,["schema"])):O("",!0)]),_:1},8,["modelValue"])],64)}}},Di={class:"right-content"},Li={key:0,class:"right-item"},$i={class:"right-item-button",style:{padding:"0"}},Mi={class:"user-info"},Ri={class:"user-name"},ji=z({__name:"Navbar",setup(e){const t=Z(),a=U(),l=V();E(!1);const i=E(!1);E(""),E(0);const n=w(()=>a.defaultAvatar),s=w(()=>t.sidebar),u=w(()=>t.device),m=w(()=>l.avatar),p=w(()=>l.name),d=w(()=>l.nickname),_=w(()=>a.nav),x=w(()=>a),v=w(()=>l),T=w(()=>a.showPageJsonSchema||!1),{isDark:B,toggleTheme:y}=Mt(),S=w(()=>{const j=x.value.envColor?.[v.value.env];return B.value?{background:"linear-gradient(135deg, rgba(59, 130, 246, 0.55) 0%, rgba(37, 99, 235, 0.45) 45%, rgba(15, 23, 42, 0.92) 100%)",borderBottom:"1px solid rgba(148, 163, 184, 0.35)",boxShadow:"0 1px 8px rgba(15, 23, 42, 0.7)"}:j?{background:`linear-gradient(135deg, rgba(255, 255, 255, 0.18) 0%, rgba(255, 255, 255, 0.05) 60%, ${j} 100%)`,borderBottom:"1px solid rgba(15, 23, 42, 0.08)",boxShadow:"0 1px 4px rgba(15, 23, 42, 0.08)"}:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 252, 0.9) 70%, #ffffff 100%)",borderBottom:"1px solid rgba(15, 23, 42, 0.08)",boxShadow:"0 1px 4px rgba(15, 23, 42, 0.05)"}});Ie(()=>{kt("el-submenu is-active");const j=Te("navBarNotice")||"";j.length>0&&!Te("closeNavNotice")&&aa(j)&&window?.App?.config?.globalProperties?.$notify({title:"æç¤º",message:j,dangerouslyUseHTMLString:!0,duration:0,onClose:ta}),x.value.envColor?.[v.value.env]&&pa({elRef:P.value.$el,waterMark:v.value.env,color:"skyblue",size:"20"})});const P=E(),D=E(""),C=E(!1);he([m,n],()=>{C.value=!1,D.value=m.value||n.value||""},{immediate:!0});const F=w(()=>{const j=d.value||p.value||a.title||"ç”¨æˆ·";return j?j.toString().trim().charAt(0).toUpperCase():"ç”¨"});function K(){t.toggleSideBar()}async function ea(){await l.logout();const j=window?.App?.config?.globalProperties?.$router?.currentRoute?.value;location.reload(`${location.origin}/#/login?redirect=${j?.fullPath||"/"}`)}function Te(j){return a[j]}async function ta(){a.updateSettings({closeNavNotice:!0}),la(Te("navBarNotice"))}function aa(j){const q="dismiss:navbar_notice";return ve.exist(q)?ve.get(q)!==j:!0}function la(j){ve.set("dismiss:navbar_notice",j)}function ia(){C.value||(C.value=!0,D.value="")}return(j,q)=>{const lt=fe,na=xa,oa=It,sa=Ea,it=Ta,ra=Ia,ua=Sa,ca=Tt,da=oe;return o(),h(da,{ref_key:"header",ref:P,class:"navbar",style:dl(S.value)},{default:r(()=>[c(lt,{span:16},{default:r(()=>[c(Fl,{"is-active":s.value.opened,class:"hamburger-container",onToggleClick:K},null,8,["is-active"]),u.value!=="mobile"?(o(),h(Nl,{key:0,class:"breadcrumb-container"})):O("",!0)]),_:1}),c(lt,{span:8},{default:r(()=>[k("div",Di,[T.value?(o(),g("div",Li,[c(Pi)])):O("",!0),k("div",$i,[c(f(Ke),{buttons:_.value},null,8,["buttons"])]),c(oa,{placement:"bottom",content:f(B)?"åˆ‡æ¢ä¸ºæ˜äº®æ¨¡å¼":"åˆ‡æ¢ä¸ºæš—é»‘æ¨¡å¼"},{default:r(()=>[k("div",{class:"right-item theme-toggle",role:"button",tabindex:"0",onClick:q[0]||(q[0]=(...ie)=>f(y)&&f(y)(...ie)),onKeydown:[q[1]||(q[1]=ot(st((...ie)=>f(y)&&f(y)(...ie),["prevent"]),["enter"])),q[2]||(q[2]=ot(st((...ie)=>f(y)&&f(y)(...ie),["prevent"]),["space"]))]},[c(na,null,{default:r(()=>[(o(),h(Xe(f(B)?f(Xa):f(Qa))))]),_:1})],32)]),_:1},8,["content"]),c(ua,{class:"right-item",trigger:"click"},{dropdown:r(()=>[c(ra,{class:"user-dropdown"},{default:r(()=>[c(it,{icon:"oms-icon-index",onClick:q[3]||(q[3]=ie=>j.$router.push("/"))},{default:r(()=>[...q[4]||(q[4]=[I("é¦–é¡µ",-1)])]),_:1}),c(it,{divided:"",icon:"el-icon-switch-button",onClick:ea},{default:r(()=>[...q[5]||(q[5]=[I("é€€å‡ºç™»å½•",-1)])]),_:1})]),_:1})]),default:r(()=>[k("div",Mi,[c(sa,{class:"user-avatar",size:32,src:D.value||void 0,onError:ia},{default:r(()=>[I(L(F.value),1)]),_:1},8,["src"]),k("span",Ri,L(d.value||p.value),1)])]),_:1})])]),_:1}),i.value?(o(),h(ca,{key:0,"with-header":!1,size:"50%"})):O("",!0)]),_:1},8,["style"])}}}),Vi=$(ji,[["__scopeId","data-v-c2dc5c82"]]),Ni={class:"sidebar-logo-fallback"},qi={key:1,class:"sidebar-logo-fallback"},Ui={class:"sidebar-logo-fallback"},Fi={key:1,class:"sidebar-logo-fallback"},Gi={class:"sidebar-title"},Hi=z({__name:"Logo",props:{collapse:{type:Boolean}},setup(e){const t=U(),a=w(()=>t.title),l=w(()=>t.logo),i=E(!1),n=w(()=>!!l.value&&!i.value),s=w(()=>{const m=a.value||"OMS";return m?m.toString().trim().charAt(0).toUpperCase():"O"});he(l,()=>{i.value=!1},{immediate:!0});function u(){i.value=!0}return(m,p)=>{const d=Ca,_=M("router-link");return o(),g("div",{class:te(["sidebar-logo-container",{collapse:e.collapse}])},[c(rl,{name:"sidebarLogoFade"},{default:r(()=>[e.collapse?(o(),h(_,{key:"collapse",class:"sidebar-logo-link",to:"/"},{default:r(()=>[n.value?(o(),h(d,{key:0,src:l.value||"",fit:"contain",class:"sidebar-logo",onError:u},{error:r(()=>[k("div",Ni,L(s.value),1)]),_:1},8,["src"])):(o(),g("div",qi,L(s.value),1)),p[0]||(p[0]=k("div",{class:"sidebar-subtitle"},"ç³»ç»Ÿ",-1))]),_:1})):(o(),h(_,{key:"expand",class:"sidebar-logo-link",to:"/"},{default:r(()=>[n.value?(o(),h(d,{key:0,src:l.value||"",fit:"contain",class:"sidebar-logo",onError:u},{error:r(()=>[k("div",Ui,L(s.value),1)]),_:1},8,["src"])):(o(),g("div",Fi,L(s.value),1)),k("h1",Gi,L(a.value),1)]),_:1}))]),_:1})],2)}}}),zi=$(Hi,[["__scopeId","data-v-d170b6a7"]]),Ki={props:{to:{type:String,required:!0},newTab:{type:Boolean,required:!1}},methods:{compType(e){return nt(e)||this.newTab?"a":"router-link"},linkProps(e){return nt(e)?{is:"a",href:e,target:"_blank",rel:"noopener"}:this.newTab?{is:"a",href:this.$router.resolve(e).href,target:"_blank",rel:"noopener"}:{is:"router-link",to:e}}}};function Ji(e,t,a,l,i,n){return o(),h(Xe(n.compType(a.to)),Q(se(n.linkProps(a.to))),{default:r(()=>[de(e.$slots,"default")]),_:3},16)}const Wi=$(Ki,[["render",Ji]]),Xi={computed:{device(){return this.$pinia?.state?.value?.app?.device||"desktop"}},mounted(){this.fixBugIniOS()},methods:{fixBugIniOS(){const e=this.$refs.subMenu;if(e){const t=e.handleMouseleave;e.handleMouseleave=a=>{this.device!=="mobile"&&t(a)}}}}},Qi={class:"menu-content"},Zi=z({__name:"MenuContent",props:{meta:{type:Object,default:()=>({icon:"",title:""})}},setup(e){return(t,a)=>{const l=M("VIcon");return o(),g(A,null,[c(l,{name:e.meta.icon||"ra-all"},null,8,["name"]),k("span",Qi,L(e.meta.title),1)],64)}}}),Yi={name:"SidebarItem",components:{AppLink:Wi,MenuContent:Zi},mixins:[Xi],props:{item:{type:Object,required:!0},isNest:{type:Boolean,default:!1},to:{type:String,default:""},isCollapse:{type:Boolean,default:!1}},methods:{itemClick(){ve.remove("table_filter:"+this.$props.to)},getTo(e){try{return this.$router.resolve(e.redirect?e.redirect:e).fullPath}catch{return console.error("è·¯ç”±è§£æé”™è¯¯"),"/"}}}},en={key:0,class:"menu-wrapper"};function tn(e,t,a,l,i,n){const s=M("menu-content"),u=Aa,m=M("app-link"),p=It,d=M("sidebar-item",!0),_=Pa;return a.item.hidden!==!1?(o(),g("div",en,[a.item.meta&&a.item.meta.menuType===2?(o(),h(p,{key:0,disabled:!a.isCollapse,effect:"dark",placement:"right",content:a.item.meta?.title},{default:r(()=>[a.item.meta?(o(),h(m,{key:0,to:a.to,"new-tab":a.item.meta.newTab},{default:r(()=>[c(u,{index:a.to,class:te({"submenu-title-noDropdown":!a.isNest}),onClick:n.itemClick},{default:r(()=>[c(s,{meta:a.item.meta},null,8,["meta"])]),_:1},8,["index","class","onClick"])]),_:1},8,["to","new-tab"])):O("",!0)]),_:1},8,["disabled","content"])):a.item.meta&&a.item.meta.menuType===1?(o(),h(p,{key:1,disabled:!a.isCollapse,effect:"dark",placement:"right",content:a.item.meta?.title},{default:r(()=>[c(_,{ref:"subMenu",index:a.to,class:te({"submenu-title-noDropdown":!a.isNest})},{title:r(()=>[a.item.redirect&&a.item.redirect!=="#"?(o(),h(m,{key:0,to:a.to},{default:r(()=>[c(s,{meta:a.item.meta},null,8,["meta"])]),_:1},8,["to"])):(o(),h(s,{key:1,meta:a.item.meta},null,8,["meta"]))]),default:r(()=>[(o(!0),g(A,null,N(a.item.children,x=>(o(),h(d,{key:x.path,"is-nest":!0,item:x,to:n.getTo(x),class:"nest-menu"},null,8,["item","to"]))),128))]),_:1},8,["index","class"])]),_:1},8,["disabled","content"])):O("",!0)])):O("",!0)}const an=$(Yi,[["render",tn]]),ln=z({__name:"SearchMenu",setup(e){const t=V();function a(p){return p.filter(d=>d.meta?.menuType===0?!1:(d.children&&(d.children=a(d.children),d.children.length===0&&delete d.children),!0))}const l=E(""),i=w(()=>t.remoteRouter),n=Ee(),s=w(()=>{let p=[];return i.value.forEach(d=>{p=p.concat(b.cloneDeep(d.routes))}),a(p)});function u(p){let d=p;if(p.meta.menuType===1&&p.children&&p.children.length>0){for(let _=0;_<p.children.length;_++)if(p.children[_].path.indexOf("/:")===-1){d=p.children[_];break}}return n.resolve(d.redirect?d.redirect:d).fullPath}function m(p){n.push(p),l.value=""}return(p,d)=>{const _=Fe,x=Oa,v=Ge;return o(),h(v,{modelValue:f(l),"onUpdate:modelValue":d[0]||(d[0]=T=>We(l)?l.value=T:null),filterable:"",placeholder:"æœç´¢èœå•...",class:"search-menu",onChange:m},{default:r(()=>[(o(!0),g(A,null,N(f(s),T=>(o(),g(A,{key:T.path},[T.children!==void 0?(o(),g(A,{key:0},[T.meta.menuType!==0?(o(),h(x,{key:T.path+"-",label:T.meta.title},{default:r(()=>[(o(!0),g(A,null,N(T.children,(B,y)=>(o(),g(A,{key:B.path},[T.meta.menuType!==0?(o(),h(_,{key:0,label:(y===T.children.length-1?"â””â”€":"â”œâ”€")+B.meta.title,value:u(B)},null,8,["label","value"])):O("",!0)],64))),128))]),_:2},1032,["label"])):O("",!0)],64)):(o(),h(_,{key:1,label:""+T.meta.title,value:u(T)},null,8,["label","value"]))],64))),128))]),_:1},8,["modelValue"])}}}),nn=$(ln,[["__scopeId","data-v-1821c9c2"]]);var J=(e=>(e[e.custom=0]="custom",e[e.list=1]="list",e[e.form=2]="form",e[e.customSchema=3]="customSchema",e[e.localComp=4]="localComp",e[e.tree=5]="tree",e[e.report=6]="report",e[e.entity=7]="entity",e))(J||{}),H=(e=>(e[e.hidden=0]="hidden",e[e.dir=1]="dir",e[e.menu=2]="menu",e[e.page=3]="page",e))(H||{});const on=z({__name:"index",setup(e){const t=Z(),a=V(),l=U(),i=w(()=>t.sidebar),n=w(()=>a.remoteRouter),s=w(()=>a.customRouter),u=Ee(),m=W(),p=w(()=>{let y=[];return u.options.routes.concat(s.value||[]).forEach(S=>{S.path==="/"?y=y.concat(S.children||[]):y.push(S)}),b.cloneDeep([{label:"",routes:y},...n.value])}),d=w(()=>{const y=m.matched;for(let S=y.length-1;S>=0;S--){const P=y[S];if(P.meta.menuType===H.menu)return T(),u.resolve(P.redirect?P.redirect:P).fullPath}return""}),_=w(()=>l.sidebarLogo),x=w(()=>({menuBg:"#304156",menuText:"#bfcbd9",menuActiveText:"#409EFF"})),v=w(()=>!i.value.opened);Ie(()=>T());function T(){kt("is-active",200)}function B(y){return y.filter(S=>[H.dir,H.menu].indexOf(S.meta.menuType)!==-1).map(S=>(S=Object.assign({},S),S.children&&(S.children=B(S.children)),S))}return(y,S)=>{const P=_a,D=wa;return o(),g("div",{class:te({"has-logo":f(_)})},[f(_)?(o(),h(zi,{key:0,collapse:f(v)},null,8,["collapse"])):O("",!0),c(D,{"wrap-class":"scrollbar-wrapper"},{default:r(()=>[f(v)?O("",!0):(o(),h(nn,{key:0})),c(P,{"default-active":f(d),collapse:f(v),"background-color":f(x).menuBg,"text-color":f(x).menuText,"unique-opened":!1,"active-text-color":f(x).menuActiveText,"collapse-transition":!1,mode:"vertical"},{default:r(()=>[(o(!0),g(A,null,N(f(p),(C,F)=>(o(),g(A,{key:F+"-module"},[(o(!0),g(A,null,N(B(C.routes),K=>(o(),h(an,{key:K.path,item:K,to:y.$router.resolve(K.redirect?K.redirect:K).fullPath,"is-collapse":f(v)},null,8,["item","to","is-collapse"]))),128))],64))),128))]),_:1},8,["default-active","collapse","background-color","text-color","active-text-color"])]),_:1})],2)}}}),sn=$(on,[["__scopeId","data-v-3be8fe55"]]),rn={class:"app-main"},un={__name:"AppMain",setup(e){const t=W(),a=[],l=E(0);return Fa(()=>{t.meta?.keepAlive&&a.indexOf(t.name)&&a.push(t.name),l.value++}),(i,n)=>{const s=M("router-view"),u=Ba;return o(),g("section",rn,[(o(),h(s,{key:i.$route.fullPath+f(l)})),c(u,{bottom:50})])}}},cn=$(un,[["__scopeId","data-v-ca0f0d98"]]),dn={class:"main-container"},pn=992,mn={__name:"index",setup(e){const{body:t}=document,a=Z(),l=U(),i=W(),n=w(()=>a.sidebar),s=w(()=>a.device),u=w(()=>l.fixedHeader),m=w(()=>({hideSidebar:!n.value.opened,openSidebar:n.value.opened,withoutAnimation:n.value.withoutAnimation,mobile:s.value==="mobile"})),p=()=>t.getBoundingClientRect().width-1<pn,d=()=>{if(!document.hidden){const x=p();a.toggleDevice(x?"mobile":"desktop"),x&&a.closeSideBar({withoutAnimation:!0})}};d(),Za(window,"resize",()=>d()),he(i,()=>{s.value==="mobile"&&n.value.opened&&a.closeSideBar({withoutAnimation:!1})});const _=()=>a.closeSideBar({withoutAnimation:!1});return(x,v)=>(o(),g("div",{class:te([f(m),"app-wrapper"])},[f(s)==="mobile"&&f(n).opened?(o(),g("div",{key:0,class:"drawer-bg",onClick:_})):O("",!0),c(f(sn),{class:"sidebar-container"}),k("div",dn,[k("div",{class:te({"fixed-header":f(u)})},[c(f(Vi))],2),c(f(cn))])],2))}},Ut=$(mn,[["__scopeId","data-v-6bf05d7c"]]),fn={id:"login"},hn={id:"form"},bn={key:0,class:"captcha"},yn=["src"],vn={class:"tips"},gn={class:"sso"},kn=z({__name:"login",setup(e){const t=Ee(),a=W(),l=U(),i=Z(),n=V(),s=w(()=>l.loginTips),u=w(()=>l.captcha),m=w(()=>i.baseURL),p=E(0),d=E(!1),_=()=>p.value++,x=w(()=>v.value.username.length>0&&v.value.password.length>=4&&(u.value?v.value.captcha.length===4:!0)),v=E({username:"",password:"",captcha:"",sing:""}),T=()=>{if(!d.value){if(v.value.username===""||v.value.password===""||u.value&&v.value.captcha===""){Et.error("ç”¨æˆ·å, å¯†ç , éªŒè¯ç æ˜¯å¿…é¡»çš„");return}u.value&&(v.value.sing=el.MD5(`${v.value.username}${v.value.password}${v.value.captcha}`).toString()),d.value=!0,n.login(v.value).then(B=>{t.push({path:a.query?.redirect||"/"})}).catch(B=>{p.value++}).finally(()=>{d.value=!1})}};return(B,y)=>{const S=pe;return o(),g("div",fn,[y[5]||(y[5]=k("h1",{id:"title"},"ç™»å½•",-1)),k("form",hn,[ke(k("input",{"onUpdate:modelValue":y[0]||(y[0]=P=>f(v).username=P),type:"text",placeholder:"ç”¨æˆ·å",class:"input"},null,512),[[Ce,f(v).username]]),ke(k("input",{"onUpdate:modelValue":y[1]||(y[1]=P=>f(v).password=P),type:"password",placeholder:"å¯†ç ",class:"input"},null,512),[[Ce,f(v).password]]),u.value?(o(),g("div",bn,[ke(k("input",{"onUpdate:modelValue":y[2]||(y[2]=P=>f(v).captcha=P),type:"text",placeholder:"éªŒè¯ç ",class:"input-captcha"},null,512),[[Ce,f(v).captcha]]),k("img",{class:"captcha-img",src:m.value+"/user/captcha?ts="+f(p),title:"ç‚¹å‡»åˆ·æ–°",onClick:_},null,8,yn)])):O("",!0),c(S,{class:"login-button",type:"primary",loading:f(d),disabled:!x.value,onClick:T},{default:r(()=>[...y[3]||(y[3]=[I("ç™»å½•",-1)])]),_:1},8,["loading","disabled"]),k("div",vn,[k("div",null,L(s.value),1)]),k("div",gn,[y[4]||(y[4]=k("div",{id:"sso-qrcode"},null,-1)),(o(!0),g(A,null,N(Object.keys([]),P=>(o(),g("div",{key:P},L(P),1))),128))])])])}}}),_n={name:"NotFoundPage"},wn={class:"not-found"};function xn(e,t,a,l,i,n){return o(),g("div",wn,[...t[0]||(t[0]=[k("svg",{width:"380px",height:"500px",viewBox:"0 0 837 1045",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:sketch":"http://www.bohemiancoding.com/sketch/ns"},[k("g",{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd","sketch:type":"MSPage"},[k("path",{id:"Polygon-1",d:"M353,9 L626.664028,170 L626.664028,487 L353,642 L79.3359724,487 L79.3359724,170 L353,9 Z",stroke:"#007FB2","stroke-width":"6","sketch:type":"MSShapeGroup"}),k("path",{id:"Polygon-2",d:"M78.5,529 L147,569.186414 L147,648.311216 L78.5,687 L10,648.311216 L10,569.186414 L78.5,529 Z",stroke:"#EF4A5B","stroke-width":"6","sketch:type":"MSShapeGroup"}),k("path",{id:"Polygon-3",d:"M773,186 L827,217.538705 L827,279.636651 L773,310 L719,279.636651 L719,217.538705 L773,186 Z",stroke:"#795D9C","stroke-width":"6","sketch:type":"MSShapeGroup"}),k("path",{id:"Polygon-4",d:"M639,529 L773,607.846761 L773,763.091627 L639,839 L505,763.091627 L505,607.846761 L639,529 Z",stroke:"#F2773F","stroke-width":"6","sketch:type":"MSShapeGroup"}),k("path",{id:"Polygon-5",d:"M281,801 L383,861.025276 L383,979.21169 L281,1037 L179,979.21169 L179,861.025276 L281,801 Z",stroke:"#36B455","stroke-width":"6","sketch:type":"MSShapeGroup"})])],-1),k("div",{class:"message-box"},[k("h1",null,"404"),k("p",null,"Page not found"),k("div",{class:"buttons-con"},[k("div",{class:"action-link-wrap"},[k("a",{href:"",class:"link-button"},"Go to Home Page")])])],-1)])])}const Sn=$(_n,[["render",xn],["__scopeId","data-v-26068803"]]),En=[{path:"/",component:Ut,redirect:"/dashboard",name:"Root",meta:{menuType:1},children:[{path:"dashboard",name:"Dashboard",component:$l,meta:{title:"Dashboard",icon:"el-icon-help",menuType:2,keepAlive:!0}}]},{path:"/login",component:kn,meta:{title:"ç”¨æˆ·ç™»å½•",menuType:0},hidden:!0},{path:"/404",component:Sn,meta:{menuType:0},hidden:!0}],ae=qa({history:Ua(),routes:En});Me.configure({showSpinner:!1});function In(e){e.beforeEach((t,a,l)=>{Me.start(),t.preHash=location.hash.replace("#",""),l()}),e.afterEach(t=>{const a=V(R);t.matched.length>0&&a.updateState({key:"path",value:t.matched[t.matched.length-1].path.replace("(\\d+)","")}),Me.done()})}function Tn(){return V(R).isLodeRemoteRoutes}function Ft(){return U(R).whiteRoutes||[]}function Bn(){return V(R).token}const Cn={};function On(){return b.merge(U(R).sso||{},Cn)}function An(){const e=On(),t=U(R).activeSsoKey||"",a=e[t];if(a!==void 0)return a()}function Pn(e){e.beforeEach(async(t,a,l)=>{if(Ft().indexOf(t.path)!==-1){l();return}if(Bn()){t.query?.redirect?l(t.query?.redirect):l();return}const i=t.query.redirect||t.path,n=An();if(!n){l(`/login?redirect=${i}`);return}const s=n.flag(),u=V(R);if(s&&await u.login(b.isObject(s)?s:{ticket:s})){l();return}n.jumpToLoginPage(l,`/login?redirect=${i}`)})}const Dn={},Ln={class:"loading preloader"};function $n(e,t){return o(),g("div",Ln,[...t[0]||(t[0]=[k("div",{class:"preloader-inner"},null,-1)])])}const Mn=$(Dn,[["render",$n]]),Rn={name:"VNotice",props:{dataApi:{type:String,default:""},notice:{type:Object,default:()=>{}}},data(){return{noticeProps:{},hasNotice:!1}},mounted(){if(this.$props.dataApi,this.$props.dataApi){this.$http.get(this.$props.dataApi).then(({data:e})=>{this.noticeProps=e,this.hasNotice=!!e});return}else this.hasNotice=Object.keys(this.$props.notice).length>0,this.noticeProps=this.$props.notice}};function jn(e,t,a,l,i,n){const s=He;return o(),g("div",null,[i.hasNotice?(o(),h(s,Q(X({key:0},i.noticeProps)),null,16)):O("",!0)])}const Vn=$(Rn,[["render",jn]]),Nn=["innerHTML"],qn=z({__name:"PageLoad",props:{schemaHandler:{type:Function,default:e=>e},schemaApi:{default:""}},setup(e){const t=e,a=Z(),l=U(),i=V(),n=W(),s=E(!0),u=E(!1),m=E({}),p=E(""),d=E({}),_=E([]),x=E(!1),v=w(()=>i.env),T=w(()=>l);return Qe(()=>{const B=n.path.split("/").filter(D=>D),y=B.length>1?B.slice(0,B.length-1).join("/"):B[0],S="/schema"+n.meta.path,P={params:n.params};(window?.App?.config?.globalProperties?.$http).get(t.schemaApi||S,P).then(({data:D})=>{s.value=!1,ne(D)&&(D.notice!==void 0&&(u.value=!0,qe(D.notice)?m.value={title:D.notice}:ne(D.notice)&&(m.value=D.notice,p.value=D.notice.noticeApi),delete D.notice),_.value=D.ownerNames||[],x.value=D.serviceOffLine||!1),d.value=t.schemaHandler(D,y),a.SET_PAGE_JSON_SCHEMA({page:n.path,json:d.value})})}),(B,y)=>{const S=He;return o(),g(A,null,[f(_).length>0?(o(),h(S,{key:0,title:`è¯¥é¡µé¢åŠŸèƒ½å¯¹åº”å¼€å‘: [ ${f(_).join(", ")} ] æœ‰é—®é¢˜å¯ç›´æ¥ä¼å¾®åé¦ˆ`,type:"info",style:{margin:"0 0 20px 0"},closable:!1},null,8,["title"])):O("",!0),f(v)==="prod"&&f(x)?(o(),g("div",{key:1,class:"offline-notice",innerHTML:f(x)===!0?f(T).serviceOffLineNotice:f(x)},null,8,Nn)):(o(),g(A,{key:2},[f(u)?(o(),h(Vn,{key:0,notice:f(m),style:{margin:"0 0 20px 0"},"data-api":f(p)},null,8,["notice","data-api"])):O("",!0),f(s)?(o(),h(Mn,{key:1})):de(B.$slots,"default",Q(X({key:2},f(d))),void 0,!0)],64))],64)}}}),ye=$(qn,[["__scopeId","data-v-e330fdc7"]]),Gt={__name:"table",setup(e){const t=(a,l)=>{if(a.orderBy){const n={prop:a.orderBy.field,order:a.orderBy.mod==="desc"?"descending":"ascending"};a.tableProps=b.merge(a.tableProps,{defaultSort:n})}const i=Object.keys(me.props);return Object.keys(a).forEach(n=>{i.indexOf(n)===-1&&delete a[n]}),a.listApi===void 0&&(a.listApi=`/${l}/list`),a};return(a,l)=>(o(),h(ye,{"schema-handler":t},{default:r(i=>[c(f(me),Q(se(i)),null,16)]),_:1}))}},Ve={__name:"form",setup(e){const t=W(),a=Ee(),l=(u,m)=>{const p=Object.keys(ee.props);return Object.keys(u).forEach(d=>{if(p.indexOf(d)===-1){delete u[d];return}/.*Api$/.test(d)&&(u[d]=ge(u[d],t.params))}),u.saveApi===void 0&&(t.params.id!==void 0?(u.saveApi=`/${m}/update/${t.params.id}`,u.getApi||(u.getApi=`/${m}/get/${t.params.id}`)):(delete u.getApi,u.saveApi=`/${m}/create`)),u=b.merge({saveApi:m+"/save",afterSubmit:"goback",afterReset:"goback",mod:t.params.id?"edit":"create"},u),u},i=E(0),n=()=>{Qt.request({url:"/form_mutex",method:"get",params:{path:t.fullPath}}).then(u=>{u.data&&(clearInterval(i.value),St.alert(`${u.data}`,"æ“ä½œæé†’",{showClose:!1,showCancelButton:!0,confirmButtonText:"è¿”å›",cancelButtonText:"åˆ·æ–°",callback:m=>{m==="cancel"?location.reload():s()}}))})};Ie(()=>{const u=U();t.params.id!==void 0&&u.formMutex&&(n(),i.value=setInterval(n,2e3))}),il(()=>{clearInterval(i.value)});function s(){t.query?.goback?a.push(t.query?.goback):history.state.back&&history.back()}return(u,m)=>(o(),h(ye,{"schema-handler":l},{default:r(p=>[c(f(ee),Q(se(p)),null,16)]),_:1}))}},Un=z({name:"VTree",components:{VForm:ee},props:{treeApi:{type:String,default:"",require:!0},getApi:{type:String,default:"",require:!0},saveApi:{type:String,default:"",require:!0},createApi:{type:String,default:"",require:!0},deleteApi:{type:String,default:"",require:!0},formItems:{type:Array,default:()=>[]},treeProps:{type:Object,default:()=>{}},maxDepth:{type:Number,default:3},props:{type:Object,default:()=>{}}},data(){return{type:0,treeData:[],formData:{},localTreeProps:b.merge({"default-expand-all":!0,"expand-on-click-node":!1,props:{children:"children",label:"label"}},this.$props.treeProps),formkey:0,tablekey:0,menuOptions:{}}},computed:{formType(){return["","æ–°å»º","ç¼–è¾‘"][this.type]},formProps(){let e=ge(this.$props.saveApi,this.formData);return this.type===1&&(e=this.$props.createApi),{saveApi:e,getApi:this.$props.getApi,formItems:this.$props.formItems}}},created(){this.loadTree()},methods:{loadTree(){this.$http.request({method:"GET",url:this.$props.treeApi}).then(({data:e})=>{this.treeData=e})},onclick(e){this.type=2,this.formData=e,this.formkey++},append(e,t){this.type=1;const a={pid:e.id,[this.$props.props?.levelKey??"level"]:t.level+1,...ga(this.$props.props?.effectData,e)};e.children||(e.children=[]),this.formData=a,this.formkey++,e.children.push(a),this.treeData=[...this.treeData]},canAppend(e,t){return e[this.localTreeProps.props.label]?t.level<this.$props.maxDepth:!1},appendNew(){this.type=1;const e={pid:0,[this.$props.props?.levelKey??"level"]:1};this.formData=e,this.formkey++,this.tablekey++,this.treeData=[...this.treeData,e]},remove(e){this.$http.request({method:"DELETE",url:ge(this.$props.deleteApi,e)}).then(({code:t})=>{t!==0?this.$message.error("æ“ä½œå¤±è´¥"):this.loadTree()})},submit(){setTimeout(()=>{this.loadTree(),this.formData={},this.tablekey++,this.type=0},200)},allowDrap(e){return!0},allowDrop(e,t,a){return a==="inner"},handleDragEnd(e,t,a,l){const i=e.data;i.pid=t.data.id,this.$http.request({method:"POST",url:ge(this.$props.saveApi,i),data:i}).then(({code:n})=>{n!==0&&this.$message.error("æ“ä½œå¤±è´¥")})}}}),Fn={class:"card-header"},Gn={class:"tree-action"},Hn={key:0},zn={key:1,style:{color:"#E6A23C"}},Kn={class:"card-header"};function Jn(e,t,a,l,i,n){const s=pe,u=Va,m=Se,p=fe,d=M("v-form"),_=oe;return o(),h(_,{class:"tree-box",gutter:20},{default:r(()=>[c(p,{span:8,class:"tree-tree"},{default:r(()=>[c(m,{shadow:"never"},{header:r(()=>[k("div",Fn,[t[3]||(t[3]=k("span",null,"åˆ—è¡¨",-1)),c(s,{type:"text",onClick:t[0]||(t[0]=()=>e.appendNew())},{default:r(()=>[...t[2]||(t[2]=[I("æ·»åŠ ",-1)])]),_:1})])]),default:r(()=>[(e.treeData||[]).length>0?(o(),h(u,X({key:0,style:{height:"100vh"},data:e.treeData,"node-key":"id"},e.localTreeProps,{draggable:"","allow-drag":e.allowDrap,"allow-drop":e.allowDrop,onNodeDragEnd:e.handleDragEnd}),{default:r(({node:x,data:v})=>[k("span",Gn,[v[e.localTreeProps.props.label]?(o(),g("span",Hn,L(v[e.localTreeProps.props.label]),1)):(o(),g("span",zn,"è¯·åœ¨å³ä¾§è¡¨å•ä¸­ä¿®æ”¹ --> ")),k("span",null,[v[e.localTreeProps.props.label]?(o(),h(s,{key:0,class:"button",type:"text",onClick:()=>e.onclick(v)},{default:r(()=>[...t[4]||(t[4]=[I("ç¼–è¾‘",-1)])]),_:1},8,["onClick"])):O("",!0),e.canAppend(v,x)?(o(),h(s,{key:1,class:"button",type:"text",onClick:()=>e.append(v,x)},{default:r(()=>[...t[5]||(t[5]=[I("æ·»åŠ ",-1)])]),_:1},8,["onClick"])):O("",!0),v.children===void 0||v.children.length===0?(o(),h(s,{key:2,class:"button",type:"text",onClick:()=>e.remove(v)},{default:r(()=>[...t[6]||(t[6]=[I("åˆ é™¤",-1)])]),_:1},8,["onClick"])):O("",!0)])])]),_:1},16,["data","allow-drag","allow-drop","onNodeDragEnd"])):O("",!0)]),_:1})]),_:1}),c(p,{span:16,class:"tree-form"},{default:r(()=>[e.type?(o(),h(m,{key:0,shadow:"never"},{header:r(()=>[k("div",Kn,[k("span",null,L(e.formType),1)])]),default:r(()=>[(o(),h(d,X({key:e.formkey,modelValue:e.formData,"onUpdate:modelValue":t[1]||(t[1]=x=>e.formData=x)},e.formProps,{onSubmit:e.submit}),null,16,["modelValue","onSubmit"]))]),_:1})):O("",!0)]),_:1})]),_:1})}const ft=$(Un,[["render",Jn]]),Wn={__name:"tree",setup(e){const t=(a,l)=>{const i=Object.keys(ft.props);return Object.keys(a).forEach(n=>{i.indexOf(n)===-1&&delete a[n]}),a};return(a,l)=>(o(),h(ye,{"schema-handler":t},{default:r(i=>[c(ft,Q(se(i)),null,16)]),_:1}))}},Le={__name:"container",setup(e){const t=E(0);return Ga(()=>{t.value++}),(a,l)=>{const i=M("router-view");return o(),h(i)}}},Xn={title:{text:""},tooltip:{trigger:"axis"},grid:{left:"2%",right:"2%",bottom:"5%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},legend:{data:[]},xAxis:{type:"category"},yAxis:{type:"value"},series:[]};function Qn(e,t,a){if(a.length===0)return{};let l=b.merge({},Xn);if(l.title.text=e,qe(t)){const i=[],n=Object.keys(a[0]);let s=n[0],u=n.filter((p,d)=>d>0),m=t;if(t.indexOf(":")>-1){const p=t.split(":"),d=p[1].split(",");m=p[0],s=d[0],u=d.filter((_,x)=>x>0)}u.forEach(p=>{const d=[];a.forEach(_=>{d.push(_[p])}),l.series.push({name:p,type:m,smooth:!0,data:d}),l.legend.data.push(p)}),a.forEach(p=>{i.push(p[s])}),l.xAxis.data=i}return ne(t)&&(l=b.merge(l,t)),l}const Zn=z({name:"NumberPanel",props:{dataList:{type:Array,default:e=>[]}},data(){return{}}}),Yn={class:"number-panel-title"},eo={class:"number"},to={class:"name"};function ao(e,t,a,l,i,n){return o(!0),g(A,null,N(e.dataList,(s,u)=>(o(),g("span",{key:u},[k("div",Yn,[(o(!0),g(A,null,N(Object.keys(s),(m,p)=>(o(),g("div",{key:p,class:"title-inner"},[k("p",eo,L(s[m]),1),k("p",to,L(m),1)]))),128))])]))),128)}const lo=$(Zn,[["render",ao],["__scopeId","data-v-cc0d8293"]]),io={components:{Chart:Ja,Md:Ya,Json:Je,Table:me,Number:lo,Html:""},props:{option:{type:Object,default:()=>{}}},setup(e){const t=()=>e.option.chart==="num"?"number":e.option.type;return{compprops:a=>{const l=t();if(l==="number")return{dataList:a.data};if(l==="chart")return{options:Qn(a.id,a.chart,a.data)};if(l==="md")return{source:a.data};if(l==="table"){if(!wt(a.data))return{showPagination:!1};const i=[];return a.data[0]&&Object.keys(a.data[0]).forEach((n,s)=>{i.push({field:n,label:n})}),{headers:i,list:a.data,showPagination:!1}}return{}},comptype:t}}};function no(e,t,a,l,i,n){const s=Se,u=sl("resize");return ke((o(),h(s,{shadow:"never",class:"part"},{default:r(()=>[(o(),h(Xe(l.comptype()),Q(se(l.compprops(a.option))),null,16))]),_:1})),[[u,!0]])}const oo=$(io,[["render",no],["__scopeId","data-v-a5a65cc1"]]),so=z({__name:"index",props:{filter:{type:Array,default:()=>[]},dataPart:{type:Array,default:()=>[]}},setup(e){const t=W();Ie(()=>{});const a=e,l=E({});Qe(()=>{a.filter?.forEach(d=>{d.default!==null&&(l.value[d.field]=d.default)})});const i={inline:!0,labelPosition:"right",labelWidth:"auto",submitButton:{text:"æŸ¥è¯¢"},cancelButton:{text:"é‡ç½®"}},n=E(1),s=E(a.filter),u=E(a.dataPart),m=w(()=>{let d=t.params.id;if(!d){const _=t.path.split("/");d=_[_.length-1]}return"/focusbi_report/view/"+d}),p=d=>{Qt.get(m.value,{params:d}).then(({data:_})=>{s.value=_.filter,u.value=_.dataPart,n.value++})};return(d,_)=>{const x=Se,v=fe,T=He,B=oe;return o(),h(B,null,{default:r(()=>[f(s).length>0?(o(),h(v,{key:0,span:24},{default:r(()=>[c(x,{shadow:"never",class:"part-filter"},{default:r(()=>[c(f(ee),{modelValue:f(l),"onUpdate:modelValue":_[0]||(_[0]=y=>We(l)?l.value=y:null),"form-items":f(s),options:i,onSubmit:p},null,8,["modelValue","form-items"])]),_:1})]),_:1})):O("",!0),c(v,{span:24},{default:r(()=>[c(B,{gutter:20},{default:r(()=>[(o(!0),g(A,null,N(f(u),(y,S)=>(o(),h(v,{key:S,span:y.col||24},{default:r(()=>[y.errMsg?(o(),h(T,{key:1,title:y.id+" ç‰‡æ®µæ‰§è¡Œå‡ºé”™",type:"error"},{default:r(()=>[I(L(y.errMsg),1)]),_:2},1032,["title"])):(o(),h(oo,{key:f(n),option:y},null,8,["option"]))]),_:2},1032,["span"]))),128))]),_:1})]),_:1})]),_:1})}}}),ro={__name:"report",setup(e){const t=W(),a=w(()=>{let l=t.params.id;if(!l){const i=t.path.split("/");l=i[i.length-1]}return"/focusbi_report/view/"+l});return(l,i)=>(o(),h(ye,{"schema-api":f(a)},{default:r(n=>[c(so,Q(se(n)),null,16)]),_:1},8,["schema-api"]))}},uo=e=>c("div",null,[e.test]),co={card:Se,form:ee,table:me,test:uo,row:oe,col:fe},po={card:{type:"card",props:{class:"render-card",shadow:"never"}},form:{type:"form",props:{afterReset:""}},table:{type:"table",props:{syncUrl:!1}}};function mo(e){const t=Object.assign({},e),a=t.type.split(".").reverse(),l=t.span||24;delete t.span;let i={...t,type:a[0]};for(let n=1;n<a.length;n++)i={type:a[n],children:[i]};return i.span=l,tt([i])}function tt(e){const t={type:"row",props:{gutter:20,class:"render-row"},children:[]};return e.forEach(a=>{let l=Object.assign({},a);if(ne(l.props?.style)){let s="";Object.keys(l.props?.style).forEach(u=>{s+=u+":"+l.props?.style[u]+";"}),l.props.style=s}const i={span:l.span??24,class:"render-col"};if(delete l.span,l.type.indexOf(".")>0){t.children.push({type:"col",props:i,children:mo(l)});return}l=b.merge({props:{}},po[l.type]||{},l);const n=Ht(l.children);n.length&&(l.children=tt(n)),t.children.push({type:"col",props:i,children:[l]})}),[t]}function Ht(e){return wt(e)?e:ne(e)?[e]:[]}let Ne={};const zt=e=>{const t=co[e.type]||Ne[e.type]||e.type;return ol(t,e.props,{default:()=>Ht(e.children).map(a=>zt(a))})},fo=e=>(Object.keys(Ne).length===0&&(Ne=nl().appContext.components),tt(Object.values(e.schema)).map(t=>zt(t))),ho={__name:"custom",setup(e){const t=E([]),a=(l,i)=>(t.value=al(l),l);return(l,i)=>(o(),h(ye,{"schema-handler":a},{default:r(()=>[c(f(fo),{schema:f(t)},null,8,["schema"])]),_:1}))}};let ue={};function bs(e){ue=e}const bo=e=>{const t=a=>{const l="./views/"+a+".vue";return ue&&ue[l]&&ue[l].default?ue[l].default:(console.error(`è‡ªå®šä¹‰ç»„ä»¶ä¸å­˜åœ¨ ${e.name} ${e.view}`),Le)};if(e.path==="#")return Le;switch(e.page_type){case J.list:return Gt;case J.form:return Ve;case J.custom:case J.localComp:return t(e.view||"");case J.tree:return Wn;case J.report:return ro;case J.customSchema:return ho}return Le};function yo(e){let t=e.path;return e.type===H.menu&&e.page_type===J.entity&&(t="#"),t.indexOf(":id")>-1&&t.indexOf(":id")+3===t.length&&(t=t.replace(":id",":id(\\d+)")),t==="#"?"/"+e.id+"_DIR_"+e.name:t[0]!=="/"?"/"+t:t}function vo(e){return(e.path+e.name).split("/").filter(t=>t).join("_")}const Kt=e=>{const t=e.type!==H.page,a={path:yo(e),name:e.id+"_"+vo(e)+"_"+e.path.replaceAll("/","_"),component:bo(e),meta:{id:e.id,pageId:e.id,title:e.name,icon:e.icon,hidden:!t,path:e.path,menuType:e.type,keepAlive:!1,role:e.role},children:e.children?e.children.map(l=>Kt(l)):[]};if(e.page_type===J.entity){const l=e.path+"/list",i=e.path+"/form",n=e.path+"/:id",s=[{path:l,name:e.name+"åˆ—è¡¨"+e.id,component:Gt,meta:{id:e.id+99999,title:"åˆ—è¡¨",hidden:!0,menuType:H.hidden,keepAlive:!1,pageId:e.id,path:e.path}},{path:i,name:e.name+"æ–°å»º"+e.id,component:Ve,meta:{id:e.id+99999+1,title:"æ–°å»º",hidden:!0,menuType:H.hidden,keepAlive:!1,pageId:e.id,path:e.path}},{path:n,name:e.name+"ç¼–è¾‘"+e.id,component:Ve,meta:{id:e.id+99999+2,title:"ç¼–è¾‘",hidden:!0,menuType:H.hidden,keepAlive:!1,pageId:e.id,path:e.path}}];a.children=[...s,...a.children]}if(a.children&&a.children.length>0){let l=!0;if(a.children.forEach(i=>{i.meta&&!i.meta.hidden&&(l=!1)}),a.meta&&(a.meta.menuType=t?H.dir:H.hidden),l){a.meta&&(a.meta.menuType=H.menu);let i="/";for(let n=0;n<a.children.length;n++)if(a.children[n].path.indexOf("/:")===-1){i=a.children[n].path;break}a.redirect=i,a.path="/"+e.id+"_DIR"+a.redirect.replaceAll("/","_").toUpperCase()}}return a},go=e=>{const t=[];return e.forEach(a=>{const l={id:a.id,label:a.label,routes:[]};a.routes.forEach(i=>{l.routes.push(Kt(i))}),t.push(l)}),t},ko="root",ht=e=>e?e.split(",").map(t=>t.trim()).filter(t=>!!t):[],_o=e=>{const t=typeof e.role=="string"?e.role:"",a=e.meta&&typeof e.meta.role=="string"?e.meta.role:"",l=[...ht(t),...ht(a)];return!l.length&&e.children&&e.children.length?[]:Array.from(new Set(l))},Jt=e=>{const t={...e};return e.meta&&(t.meta={...e.meta}),e.children&&e.children.length&&(t.children=e.children.map(a=>Jt(a))),t},wo=(e,t)=>e.length?t.length?e.some(a=>t.includes(a)):!1:!0,at=(e=[],t)=>t.includes(ko)?e.map(a=>Jt(a)):e.reduce((a,l)=>{const i=_o(l);if(!wo(i,t))return a;const n={...l};if(l.meta&&(n.meta={...l.meta}),l.children&&l.children.length){const s=at(l.children,t);if(!s.length)return a;n.children=s}return a.push(n),a},[]),xo=e=>{const t=globalThis.atob(e);let a="";for(let l=0;l<t.length;l++){const i=t.charCodeAt(l).toString(16).padStart(2,"0");a+="%"+i}try{return decodeURIComponent(a)}catch{return decodeURIComponent(encodeURIComponent(t))}},So=e=>{const t=e.replace(/-/g,"+").replace(/_/g,"/"),a=4-t.length%4,l=t+(a<4?"=".repeat(a):"");return typeof globalThis.atob=="function"?xo(l):typeof Buffer<"u"?Buffer.from(l,"base64").toString("utf-8"):""},Eo=e=>{if(!e)return null;const t=e.split(".");if(t.length<2)return null;try{const a=So(t[1]);return a?JSON.parse(a):null}catch{return null}},Wt=e=>{const t=Eo(e);return(t&&typeof t.role=="string"?t.role:"").split(",").map(a=>a.trim()).filter(a=>!!a)};function Io(e){e.beforeEach(async(t,a,l)=>{if(Ft().indexOf(t.path)!==-1){l();return}if(Tn()){l();return}const i=V(R);await i.info();const n=await i.loadRemoteRoutes(),s=go(n),u=Wt(be()),m=s.map(p=>{const d=at(p.routes,u);return{...p,routes:d}}).filter(p=>p.routes.length>0);m.forEach(p=>{p.routes.forEach(d=>{e.addRoute({path:"/",component:Ut,children:[d]})})}),e.addRoute({name:"404",path:"/:pathMatch(.*)*",redirect:"/404",hidden:!0}),i.updateRemoteRouter(m),await e.replace(t),l()})}function To(e){e.beforeEach(async(t,a,l)=>{const i=[U(R).title||""],n=t.matched.length;for(let s=n;s>n-3;s--){const u=t.matched[s-1];u?.meta?.title&&i.push(u.meta.title+"")}i.length>1&&(document.title=i.reverse().join("-")),l()}),e.afterEach(async(t,a,l)=>{const i=Z(R);Object.keys(t.meta).length>0&&await i.setCurrentMeta(t.meta)})}function Bo(e){Pn(e),In(e),Io(e),To(e)}Bo(ae);function Co(){return V(R).token}function Oo(){return V(R).expired}function bt(e){Cl({message:e,type:"error",duration:5*1e3,grouping:!0})}const Ao={onFulfilled:function(e){e.headers=e.headers||{};const t=Co();return t&&(e.headers["X-Token"]=t),ae.currentRoute.value.meta?.path&&(e.headers["X-Path"]=ae.currentRoute.value.meta.path),e}},Po={onFulfilled(e){if(!(e.config?.notHoldApiErr!==void 0&&e.config?.notHoldApiErr===!0)&&e.data.code!==0){const a=e.data.message||`æ¥å£è¯·æ±‚é”™è¯¯ ${e.config.method}::${e.config.url?.split("?")[0]}`;if(e.data.code===401){if(Oo())return;V(R).SetExpired(),pt.alert("ç™»å½•ä¿¡æ¯å·²è¿‡æœŸæˆ–æœªç™»å½•, æ˜¯å¦è·³è½¬ç™»å½•","æ“ä½œæé†’",{showClose:!1,confirmButtonText:"é‡æ–°ç™»å½•",showCancelButton:!0,cancelButtonText:"å–æ¶ˆ",callback:l=>{l==="confirm"&&(At(),location.href=location.origin+location.pathname+location.hash.replace("#","#/?redirect="),location.reload()),V(R).SetExpired()}});return}else bt(a);return Promise.reject(a)}let t=e.data?.data?._message_box;return t!==void 0&&(qe(t)&&(t={message:e.data?.data?._message_box}),pt({title:"æç¤º",type:"success",grouping:!0,...t})),e.data},onRejected(e){return ze.isCancel(e)?Promise.reject(""):(bt(`${e.message} ${e.config.method}::${e.config.url?.split("?")[0]}`),Promise.reject(e))}},Do=[{request:Al,response:Pl},{request:Ao,response:Po}];function Xt(e={}){const t=Ye.axios||{},a=b.merge(t,e||{}),l=ze.create({...a});return Do.forEach(i=>{l.interceptors.request.use(i.request.onFulfilled,i.request.onRejected),l.interceptors.response.use(i.response.onFulfilled,i.response.onRejected)}),l}const Qt=Xt(),Lo={beforeMount(e,t){e.clickOutsideEvent=function(a){e===a.target||e.contains(a.target)||t.value(a,e)},document.body.addEventListener("click",e.clickOutsideEvent)},unmounted(e){document.body.removeEventListener("click",e.clickOutsideEvent)}},le=Wa(),$o={mounted:(e,t)=>{e!==null&&(t.value,e.oncontextmenu=a=>{a.preventDefault(),a.stopPropagation(),a.cancelBubble=!0,t.value&&le.emit("right-click",{event:a,data:t.value})})}},Mo={mounted(e){}};function yt(e,t){let a=e[`offset${t}`],l=e.offsetParent;for(;l;)a+=l[`offset${t}`],l=l.offsetParent;return a}const Ro={mounted:(e,t)=>{if(e===null||!t.value.dev)return;let a=e;if(t.value.parent)for(let m=0;m<t.value.parent;m++)a.parentElement&&(a=a.parentElement);a.classList.add("devtool-hover");const l=document.createElement("i");l.className="devtool-item-wrapper",a.onmouseover=()=>{l.style.height=a.offsetHeight+30+"px",l.style.width=a.offsetWidth+30+"px",l.style.top=yt(a,"Top")-15+"px",l.style.left=yt(a,"Left")-15+"px"};const i=document.createElement("span");i.className="dev-action-edit",i.title="ç¼–è¾‘";const n=document.createElement("i");n.className="iconfont ra-editor1",i.appendChild(n),i.onclick=m=>{le.emit("dev-action",{event:m,data:{type:"edit",devId:t.value.devId}})},l.appendChild(i);const s=document.createElement("span");s.className="dev-action-del",s.title="åˆ é™¤";const u=document.createElement("i");u.className="iconfont ra-cut",s.appendChild(u),s.onclick=m=>{le.emit("dev-action",{event:m,data:{type:"del",devId:t.value.devId}})},l.appendChild(s),a.insertBefore(l,a.firstChild)}},jo=Object.freeze(Object.defineProperty({__proto__:null,devtool:Ro,outClick:Lo,resize:Mo,rightClick:$o},Symbol.toStringTag,{value:"Module"}));let $e;const Zt=[],vt=new Set,gt=e=>typeof e.name=="string"?e.name:e.path;function ys(e){const t=b.merge(Ye,e),a=cl(wl),l=Ho(t),i=t.plugins||[];i.unshift(l),i.forEach(m=>{Go(a,m)}),t?.mock&&Bl(),$e=Xt(t.axios),vl(a);const n=Z(R),s=U(R),u=V(R);ml($e),s.updateSettings(e?.settings||{}),n.setBaseAPI(t?.axios.baseURL),a.config.globalProperties.$http=$e,a.config.globalProperties.$router=ae,window.App=a,window.OmsOptions=t,za(()=>({"X-Token":be()})),he(()=>u.token,()=>{Yt()},{immediate:!0}),ae.isReady().then(()=>a.mount("#app"))}function Vo(e,t={}){Object.keys(t).forEach(a=>{e.component(a,t[a])})}function Yt(){const e=Wt(be()),t=at(Zt,e),a=V(R),l=new Set(a.customRouter.map(n=>gt(n))),i=t.filter(n=>{const s=gt(n);return vt.has(s)||l.has(s)?!1:(vt.add(s),!0)});i.forEach(n=>{ae.addRoute(n)}),i.length&&a.setCustomRoutes(i)}function No(e=[]){Zt.push(...e),Yt()}function qo(e,t){t.forEach(a=>{ne(a)&&(a=[a]),e.use(...a)})}function Uo(e,t={}){Object.keys(t).forEach(a=>{e.directive(a,t[a])})}function Fo(e={}){const t=["app","settings","user"];Object.keys(e).forEach(a=>{if(t.indexOf(a)!==-1){console.warn(`storeModule name [${a}] is use by base, please change it!`);return}console.warn("[store] plugin storeModules are not supported under Pinia. Ignored:",a)})}function Go(e,t){Vo(e,t.components||{}),No(t.routes||[]),qo(e,t.use||[]),Uo(e,t.directives||{}),Fo(t.storeModules||{}),Rt(t.mockApis||[])}function Ho(e){return{components:{VIcon:Ka},directives:jo,use:[ae,[ja,{locale:xt,...e.settings?.ElementPlus}]]}}export{Ut as K,bs as d,ys as f,hs as r};
